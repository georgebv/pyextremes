
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Extreme Value Analysis (EVA) in Python">
      
      
        <meta name="author" content="George Bocharov">
      
      
      
        <link rel="prev" href="../../user-guide/6-return-periods/">
      
      
        <link rel="next" href="../extremes/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.30">
    
    
      
        <title>EVA - pyextremes</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.3cba04c6.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../css/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pyextremes.eva.EVA" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pyextremes" class="md-header__button md-logo" aria-label="pyextremes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pyextremes
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              EVA
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/georgebv/pyextremes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    georgebv/pyextremes
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pyextremes" class="md-nav__button md-logo" aria-label="pyextremes" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    pyextremes
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/georgebv/pyextremes" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    georgebv/pyextremes
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pyextremes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quickstart/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Quick Start
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/1-read-first/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Read First
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/2-extreme-value-types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extreme Value Types
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/3-block-maxima/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Block Maxima
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/4-peaks-over-threshold/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Peaks Over Threshold
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/5-threshold-selection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threshold Selection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/6-return-periods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Estimating Return Periods
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    EVA
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    EVA
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA" class="md-nav__link">
    <span class="md-ellipsis">
      EVA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EVA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.fit_model" class="md-nav__link">
    <span class="md-ellipsis">
      fit_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.from_extremes" class="md-nav__link">
    <span class="md-ellipsis">
      from_extremes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.get_extremes" class="md-nav__link">
    <span class="md-ellipsis">
      get_extremes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.get_return_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_return_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.get_summary" class="md-nav__link">
    <span class="md-ellipsis">
      get_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_corner" class="md-nav__link">
    <span class="md-ellipsis">
      plot_corner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_diagnostic" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diagnostic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_extremes" class="md-nav__link">
    <span class="md-ellipsis">
      plot_extremes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_probability" class="md-nav__link">
    <span class="md-ellipsis">
      plot_probability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_return_values" class="md-nav__link">
    <span class="md-ellipsis">
      plot_return_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_trace" class="md-nav__link">
    <span class="md-ellipsis">
      plot_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.set_extremes" class="md-nav__link">
    <span class="md-ellipsis">
      set_extremes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extremes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Extremes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Models
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plotting/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plotting
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA" class="md-nav__link">
    <span class="md-ellipsis">
      EVA
    </span>
  </a>
  
    <nav class="md-nav" aria-label="EVA">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.fit_model" class="md-nav__link">
    <span class="md-ellipsis">
      fit_model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.from_extremes" class="md-nav__link">
    <span class="md-ellipsis">
      from_extremes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.get_extremes" class="md-nav__link">
    <span class="md-ellipsis">
      get_extremes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.get_return_value" class="md-nav__link">
    <span class="md-ellipsis">
      get_return_value
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.get_summary" class="md-nav__link">
    <span class="md-ellipsis">
      get_summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_corner" class="md-nav__link">
    <span class="md-ellipsis">
      plot_corner
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_diagnostic" class="md-nav__link">
    <span class="md-ellipsis">
      plot_diagnostic
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_extremes" class="md-nav__link">
    <span class="md-ellipsis">
      plot_extremes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_probability" class="md-nav__link">
    <span class="md-ellipsis">
      plot_probability
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_return_values" class="md-nav__link">
    <span class="md-ellipsis">
      plot_return_values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.plot_trace" class="md-nav__link">
    <span class="md-ellipsis">
      plot_trace
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pyextremes.eva.EVA.set_extremes" class="md-nav__link">
    <span class="md-ellipsis">
      set_extremes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>EVA</h1>

<div class="doc doc-object doc-class">



<h2 id="pyextremes.eva.EVA" class="doc doc-heading">
          <code>pyextremes.eva.EVA</code>


<a href="#pyextremes.eva.EVA" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents first">

  
      <p>Extreme Value Analysis (EVA) class.</p>
<p>This class brings together most of the tools available in the pyextremes package
bundled together in a pipeline to perform univariate extreme value analysis.</p>
<p>A typical workflow using the EVA class would consist of the following:
    - extract extreme values (.get_extremes)
    - fit a model (.fit_model)
    - generate outputs (.get_summary)
    - visualize the model (.plot_diagnostic, .plot_return_values)</p>
<p>Multiple additional graphical and numerical methods are available
within this class to analyze extracted extreme values, visualize them,
assess goodness-of-fit of selected model, and to visualize its outputs.</p>

            <details class="quote">
              <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  29</span>
<span class="normal">  30</span>
<span class="normal">  31</span>
<span class="normal">  32</span>
<span class="normal">  33</span>
<span class="normal">  34</span>
<span class="normal">  35</span>
<span class="normal">  36</span>
<span class="normal">  37</span>
<span class="normal">  38</span>
<span class="normal">  39</span>
<span class="normal">  40</span>
<span class="normal">  41</span>
<span class="normal">  42</span>
<span class="normal">  43</span>
<span class="normal">  44</span>
<span class="normal">  45</span>
<span class="normal">  46</span>
<span class="normal">  47</span>
<span class="normal">  48</span>
<span class="normal">  49</span>
<span class="normal">  50</span>
<span class="normal">  51</span>
<span class="normal">  52</span>
<span class="normal">  53</span>
<span class="normal">  54</span>
<span class="normal">  55</span>
<span class="normal">  56</span>
<span class="normal">  57</span>
<span class="normal">  58</span>
<span class="normal">  59</span>
<span class="normal">  60</span>
<span class="normal">  61</span>
<span class="normal">  62</span>
<span class="normal">  63</span>
<span class="normal">  64</span>
<span class="normal">  65</span>
<span class="normal">  66</span>
<span class="normal">  67</span>
<span class="normal">  68</span>
<span class="normal">  69</span>
<span class="normal">  70</span>
<span class="normal">  71</span>
<span class="normal">  72</span>
<span class="normal">  73</span>
<span class="normal">  74</span>
<span class="normal">  75</span>
<span class="normal">  76</span>
<span class="normal">  77</span>
<span class="normal">  78</span>
<span class="normal">  79</span>
<span class="normal">  80</span>
<span class="normal">  81</span>
<span class="normal">  82</span>
<span class="normal">  83</span>
<span class="normal">  84</span>
<span class="normal">  85</span>
<span class="normal">  86</span>
<span class="normal">  87</span>
<span class="normal">  88</span>
<span class="normal">  89</span>
<span class="normal">  90</span>
<span class="normal">  91</span>
<span class="normal">  92</span>
<span class="normal">  93</span>
<span class="normal">  94</span>
<span class="normal">  95</span>
<span class="normal">  96</span>
<span class="normal">  97</span>
<span class="normal">  98</span>
<span class="normal">  99</span>
<span class="normal"> 100</span>
<span class="normal"> 101</span>
<span class="normal"> 102</span>
<span class="normal"> 103</span>
<span class="normal"> 104</span>
<span class="normal"> 105</span>
<span class="normal"> 106</span>
<span class="normal"> 107</span>
<span class="normal"> 108</span>
<span class="normal"> 109</span>
<span class="normal"> 110</span>
<span class="normal"> 111</span>
<span class="normal"> 112</span>
<span class="normal"> 113</span>
<span class="normal"> 114</span>
<span class="normal"> 115</span>
<span class="normal"> 116</span>
<span class="normal"> 117</span>
<span class="normal"> 118</span>
<span class="normal"> 119</span>
<span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">EVA</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extreme Value Analysis (EVA) class.</span>

<span class="sd">    This class brings together most of the tools available in the pyextremes package</span>
<span class="sd">    bundled together in a pipeline to perform univariate extreme value analysis.</span>

<span class="sd">    A typical workflow using the EVA class would consist of the following:</span>
<span class="sd">        - extract extreme values (.get_extremes)</span>
<span class="sd">        - fit a model (.fit_model)</span>
<span class="sd">        - generate outputs (.get_summary)</span>
<span class="sd">        - visualize the model (.plot_diagnostic, .plot_return_values)</span>

<span class="sd">    Multiple additional graphical and numerical methods are available</span>
<span class="sd">    within this class to analyze extracted extreme values, visualize them,</span>
<span class="sd">    assess goodness-of-fit of selected model, and to visualize its outputs.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s2">&quot;__data&quot;</span><span class="p">,</span>
        <span class="s2">&quot;__extremes&quot;</span><span class="p">,</span>
        <span class="s2">&quot;__extremes_method&quot;</span><span class="p">,</span>
        <span class="s2">&quot;__extremes_type&quot;</span><span class="p">,</span>
        <span class="s2">&quot;__extremes_kwargs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;__extremes_transformer&quot;</span><span class="p">,</span>
        <span class="s2">&quot;__model&quot;</span><span class="p">,</span>
    <span class="p">]</span>

    <span class="n">__data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span>
    <span class="n">__extremes</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">]</span>
    <span class="n">__extremes_method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">]]</span>
    <span class="n">__extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]]</span>
    <span class="n">__extremes_kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]]</span>
    <span class="n">__extremes_transformer</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">ExtremesTransformer</span><span class="p">]</span>
    <span class="n">__model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">MLE</span><span class="p">,</span> <span class="n">Emcee</span><span class="p">]]</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize EVA model.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        data : pandas.Series</span>
<span class="sd">            Time series to be analyzed.</span>
<span class="sd">            Index must be date-time and values must be numeric.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Ensure that `data` is pandas Series</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid type in &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; for the `data` argument, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;must be pandas.Series&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Copy `data` to ensure the original Series object it is not mutated</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Ensure that `data` has correct index and value dtypes</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;`data` values are not numeric - converting to numeric&quot;</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">_error</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;invalid dtype in </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2"> for the `data` argument, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;must be numeric (subdtype of numpy.number)&quot;</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">_error</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;index of `data` must be a sequence of date-time objects, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;not </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">inferred_type</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Ensure `data` doesn&#39;t have duplicate indices</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">n_duplicates</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_duplicates</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2"> duplicate indices found in `data` &quot;</span>
                <span class="s2">&quot;- removing duplicate entries&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

        <span class="c1"># Ensure that `data` is sorted</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic_increasing</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;`data` index is not sorted in ascending order - &quot;</span>
                <span class="s2">&quot;sorting `data` by index&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="c1"># Ensure that `data` has no invalid entries</span>
        <span class="n">n_nans</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">n_nans</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_nans</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2"> Null values found in `data` - removing invalid entries&quot;</span>
            <span class="p">)</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

        <span class="c1"># Set the `data` attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">=</span> <span class="n">data</span>

        <span class="c1"># Initialize attributes related to extreme value extraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_method</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_transformer</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># Initialize attributes related to model fitting</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully initialized EVA object&quot;</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__data</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extremes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;extreme values must first be extracted &quot;</span>
                <span class="s2">&quot;using the &#39;.get_extremes&#39; method&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extremes_method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_method</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;extreme values must first be extracted &quot;</span>
                <span class="s2">&quot;using the &#39;.get_extremes&#39; method&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_method</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extremes_type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;extreme values must first be extracted &quot;</span>
                <span class="s2">&quot;using the &#39;.get_extremes&#39; method&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extremes_kwargs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;extreme values must first be extracted &quot;</span>
                <span class="s2">&quot;using the &#39;.get_extremes&#39; method&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">extremes_transformer</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ExtremesTransformer</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_transformer</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;extreme values must first be extracted &quot;</span>
                <span class="s2">&quot;using the &#39;.get_extremes&#39; method&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_transformer</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">MLE</span><span class="p">,</span> <span class="n">Emcee</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
                <span class="s2">&quot;model must first be assigned using the &#39;.fit_model&#39; method&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__model</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Distribution</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">distribution</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">loglikelihood</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">loglikelihood</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">AIC</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">AIC</span>

    <span class="k">def</span> <span class="nf">test_ks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">significance_level</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">KolmogorovSmirnov</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">KolmogorovSmirnov</span><span class="p">(</span>
            <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="p">,</span>
            <span class="n">distribution</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">distribution</span><span class="p">,</span>
            <span class="n">fit_parameters</span><span class="o">=</span><span class="p">{</span>
                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit_parameters</span><span class="p">,</span>
                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">_fixed_parameters</span><span class="p">,</span>
            <span class="p">},</span>
            <span class="n">significance_level</span><span class="o">=</span><span class="n">significance_level</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="c1"># Width of repr block</span>
        <span class="n">width</span> <span class="o">=</span> <span class="mi">88</span>

        <span class="c1"># Separator used to separate two columns of the repr block</span>
        <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="mi">6</span>

        <span class="c1"># Widths of left and right columns</span>
        <span class="n">lwidth</span> <span class="o">=</span> <span class="p">(</span><span class="n">width</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="n">rwidth</span> <span class="o">=</span> <span class="n">width</span> <span class="o">-</span> <span class="p">(</span><span class="n">lwidth</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">sep</span><span class="p">))</span>

        <span class="c1"># Function used to convert label-value pair</span>
        <span class="c1"># into a sequence of lines within a column</span>
        <span class="k">def</span> <span class="nf">align_text</span><span class="p">(</span><span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">position</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
            <span class="k">assert</span> <span class="n">position</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
                    <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">lwidth</span><span class="si">}}</span><span class="s2">&quot;</span><span class="p">]</span>
                <span class="k">return</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">rwidth</span><span class="si">}}</span><span class="s2">&quot;</span><span class="p">]</span>

            <span class="c1"># Find width available for the value</span>
            <span class="c1"># (+2 stands for colon and space (label: value))</span>
            <span class="n">label_width</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">label</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
            <span class="k">if</span> <span class="n">position</span> <span class="o">==</span> <span class="s2">&quot;left&quot;</span><span class="p">:</span>
                <span class="n">free_width</span> <span class="o">=</span> <span class="n">lwidth</span> <span class="o">-</span> <span class="n">label_width</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">free_width</span> <span class="o">=</span> <span class="n">rwidth</span> <span class="o">-</span> <span class="n">label_width</span>

            <span class="c1"># Split value into chunks using &#39;free_width&#39;</span>
            <span class="n">value_chunks</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">value</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="n">free_width</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">),</span> <span class="n">free_width</span><span class="p">)</span>
            <span class="p">]</span>

            <span class="c1"># Collect text row-by-row using &#39;value_chunks&#39;</span>
            <span class="n">aligned_text</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value_chunks</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">free_width</span><span class="si">}}</span><span class="s2">&quot;</span><span class="p">]</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">value_chunks</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                    <span class="n">aligned_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                            <span class="p">[</span>
                                <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">label_width</span><span class="p">,</span>
                                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">chunk</span><span class="si">:</span><span class="s2">&gt;</span><span class="si">{</span><span class="n">free_width</span><span class="si">}}</span><span class="s2">&quot;</span><span class="p">,</span>
                            <span class="p">]</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">return</span> <span class="n">aligned_text</span>

        <span class="c1"># Function used to convert two label-value pairs</span>
        <span class="c1"># into a sequence of rows representing two columns</span>
        <span class="k">def</span> <span class="nf">align_pair</span><span class="p">(</span>
            <span class="n">label</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
            <span class="n">value</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
            <span class="n">parts</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">align_text</span><span class="p">(</span><span class="n">lbl</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">pos</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">lbl</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;left&quot;</span><span class="p">,</span> <span class="s2">&quot;right&quot;</span><span class="p">))</span>
            <span class="p">]</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">shorter_part_index</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="k">else</span> <span class="mi">1</span>
                <span class="n">parts</span><span class="p">[</span><span class="n">shorter_part_index</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="n">shorter_part_index</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">sep</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">])</span> <span class="k">for</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">parts</span><span class="p">)])</span>

        <span class="c1"># Create summary header</span>
        <span class="n">start_date</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">end_date</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">calendar</span><span class="o">.</span><span class="n">month_name</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">month</span><span class="p">]</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">year</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
        <span class="n">summary</span> <span class="o">=</span> <span class="p">[</span>
            <span class="s2">&quot;Univariate Extreme Value Analysis&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">),</span>
            <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span>
            <span class="s2">&quot;Source Data&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">),</span>
            <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span>
            <span class="n">align_pair</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;Data label&quot;</span><span class="p">,</span> <span class="s2">&quot;Size&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">align_pair</span><span class="p">(</span>
                <span class="p">(</span><span class="s2">&quot;Start&quot;</span><span class="p">,</span> <span class="s2">&quot;End&quot;</span><span class="p">),</span>
                <span class="p">(</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end_date</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="c1"># Fill the extremes section</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;Extreme Values&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">),</span>
                <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
                <span class="n">ev_parameters</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;Block size&quot;</span><span class="p">,</span>
                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]),</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;POT&quot;</span><span class="p">:</span>
                <span class="n">ev_parameters</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;Threshold&quot;</span><span class="p">,</span>
                    <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]),</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">align_pair</span><span class="p">(</span>
                        <span class="p">(</span><span class="s2">&quot;Count&quot;</span><span class="p">,</span> <span class="s2">&quot;Extraction method&quot;</span><span class="p">),</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">)</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">),</span>
                    <span class="p">),</span>
                    <span class="n">align_pair</span><span class="p">(</span>
                        <span class="p">(</span><span class="s2">&quot;Type&quot;</span><span class="p">,</span> <span class="n">ev_parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
                        <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_type</span><span class="p">,</span> <span class="n">ev_parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
                    <span class="p">),</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Extreme values have not been extracted&quot;</span><span class="p">)</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>

        <span class="c1"># Fill the model section</span>
        <span class="n">summary</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="s2">&quot;Model&quot;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">width</span><span class="p">),</span>
                <span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">width</span><span class="p">,</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">align_pair</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;Model&quot;</span><span class="p">,</span> <span class="s2">&quot;Distribution&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">name</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;Emcee&quot;</span><span class="p">:</span>
                <span class="n">n_walkers</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;n_walkers&quot;</span><span class="p">)</span>
                <span class="n">n_samples</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="s2">&quot;n_samples&quot;</span><span class="p">)</span>
                <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">align_pair</span><span class="p">(</span>
                        <span class="p">(</span><span class="s2">&quot;Walkers&quot;</span><span class="p">,</span> <span class="s2">&quot;Samples per walker&quot;</span><span class="p">),</span>
                        <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_walkers</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_samples</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
                    <span class="p">)</span>
                <span class="p">)</span>

            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                <span class="n">align_pair</span><span class="p">(</span>
                    <span class="p">(</span><span class="s2">&quot;Log-likelihood&quot;</span><span class="p">,</span> <span class="s2">&quot;AIC&quot;</span><span class="p">),</span>
                    <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">loglikelihood</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">AIC</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">),</span>
                <span class="p">)</span>
            <span class="p">)</span>

            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>

            <span class="n">free_parameters</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit_parameters</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">free_parameters</span>
            <span class="p">]</span>
            <span class="n">fixed_parameters</span> <span class="o">=</span> <span class="p">[</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">fixed_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">fixed_parameters</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">fixed_parameters</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;All parameters are free&quot;</span><span class="p">]</span>
            <span class="n">delta_parameters</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">free_parameters</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">fixed_parameters</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">delta_parameters</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">delta_parameters</span><span class="p">):</span>
                    <span class="n">free_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">delta_parameters</span><span class="p">):</span>
                    <span class="n">fixed_parameters</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">frp</span><span class="p">,</span> <span class="n">fip</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">free_parameters</span><span class="p">,</span> <span class="n">fixed_parameters</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">align_pair</span><span class="p">(</span>
                            <span class="p">(</span><span class="s2">&quot;Free parameters&quot;</span><span class="p">,</span> <span class="s2">&quot;Fixed parameters&quot;</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">frp</span><span class="p">,</span> <span class="n">fip</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="n">align_pair</span><span class="p">(</span>
                            <span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">),</span>
                            <span class="p">(</span><span class="n">frp</span><span class="p">,</span> <span class="n">fip</span><span class="p">),</span>
                        <span class="p">)</span>
                    <span class="p">)</span>

        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Model has not been fit to the extremes&quot;</span><span class="p">)</span>

        <span class="n">summary</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;=&quot;</span> <span class="o">*</span> <span class="n">width</span><span class="p">)</span>

        <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">get_extremes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">],</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">block_size</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
        <span class="n">errors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;coerce&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;raise&quot;</span><span class="p">,</span>
        <span class="n">min_last_block</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">get_extremes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;POT&quot;</span><span class="p">],</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">r</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;24h&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">get_extremes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">],</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get extreme events from time series.</span>

<span class="sd">        Extracts extreme values from the &#39;self.data&#39; attribute.</span>
<span class="sd">        Stores extreme values in the &#39;self.extremes&#39; attribute.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        method : str</span>
<span class="sd">            Extreme value extraction method.</span>
<span class="sd">            Supported values:</span>
<span class="sd">                BM - Block Maxima</span>
<span class="sd">                POT - Peaks Over Threshold</span>
<span class="sd">        extremes_type : str, optional</span>
<span class="sd">            high (default) - get extreme high values</span>
<span class="sd">            low - get extreme low values</span>
<span class="sd">        kwargs</span>
<span class="sd">            if method is BM:</span>
<span class="sd">                block_size : str or pandas.Timedelta, optional</span>
<span class="sd">                    Block size (default=&#39;365.2425D&#39;).</span>
<span class="sd">                    See pandas.to_timedelta for more information.</span>
<span class="sd">                errors : str, optional</span>
<span class="sd">                    raise (default) - raise an exception</span>
<span class="sd">                        when encountering a block with no data</span>
<span class="sd">                    ignore - ignore blocks with no data</span>
<span class="sd">                    coerce - get extreme values for blocks with no data</span>
<span class="sd">                        as mean of all other extreme events in the series</span>
<span class="sd">                        with index being the middle point of corresponding interval</span>
<span class="sd">                min_last_block : float, optional</span>
<span class="sd">                    Minimum data availability ratio (0 to 1) in the last block</span>
<span class="sd">                    for it to be used to extract extreme value from.</span>
<span class="sd">                    This is used to discard last block when it is too short.</span>
<span class="sd">                    If None (default), last block is always used.</span>
<span class="sd">            if method is POT:</span>
<span class="sd">                threshold : float</span>
<span class="sd">                    Threshold used to find exceedances.</span>
<span class="sd">                r : pandas.Timedelta or value convertible to timedelta, optional</span>
<span class="sd">                    Duration of window used to decluster the exceedances.</span>
<span class="sd">                    By default r=&#39;24H&#39; (24 hours).</span>
<span class="sd">                    See pandas.to_timedelta for more information.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;for method=&#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; and extremes_type=&#39;</span><span class="si">{</span><span class="n">extremes_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;extracting extreme values </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span> <span class="o">=</span> <span class="n">get_extremes</span><span class="p">(</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">ts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">extremes_type</span><span class="o">=</span><span class="n">extremes_type</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span> <span class="o">=</span> <span class="n">extremes_type</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully extracted extreme values </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;collecting extreme value properties&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_size&quot;</span><span class="p">,</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="s2">&quot;raise&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s2">&quot;min_last_block&quot;</span><span class="p">,</span> <span class="kc">None</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;24h&quot;</span><span class="p">))</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully collected extreme value properties&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;creating extremes transformer&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_transformer</span> <span class="o">=</span> <span class="n">ExtremesTransformer</span><span class="p">(</span>
            <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span><span class="p">,</span>
            <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully created extremes transformer&quot;</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;removing any previously declared models&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">set_extremes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">extremes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;BM&quot;</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">block_size</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
        <span class="n">errors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;coerce&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;raise&quot;</span><span class="p">,</span>
        <span class="n">min_last_block</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">set_extremes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">extremes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;POT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;POT&quot;</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">r</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;24h&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">set_extremes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">extremes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;BM&quot;</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set extreme values.</span>

<span class="sd">        This method is used to set extreme values onto the model instead</span>
<span class="sd">        of deriving them from data directly using the &#39;get_extremes&#39; method.</span>
<span class="sd">        This way user can set extremes calculated using a custom methodology.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        extremes : pd.Series</span>
<span class="sd">            Time series of extreme values to be set onto the model.</span>
<span class="sd">            Must be numeric, have date-time index, and have the same name</span>
<span class="sd">            as self.data.</span>
<span class="sd">        method : str, optional</span>
<span class="sd">            Extreme value extraction method.</span>
<span class="sd">            Supported values:</span>
<span class="sd">                BM (default) - Block Maxima</span>
<span class="sd">                POT - Peaks Over Threshold</span>
<span class="sd">        extremes_type : str, optional</span>
<span class="sd">            high (default) - extreme high values</span>
<span class="sd">            low - extreme low values</span>
<span class="sd">        kwargs:</span>
<span class="sd">            if method is BM:</span>
<span class="sd">                block_size : str or pandas.Timedelta, optional</span>
<span class="sd">                    Block size.</span>
<span class="sd">                    If None (default), then is calculated as median distance</span>
<span class="sd">                    between extreme events.</span>
<span class="sd">                errors : str, optional</span>
<span class="sd">                    raise - raise an exception</span>
<span class="sd">                        when encountering a block with no data</span>
<span class="sd">                    ignore (default) - ignore blocks with no data</span>
<span class="sd">                    coerce - get extreme values for blocks with no data</span>
<span class="sd">                        as mean of all other extreme events in the series</span>
<span class="sd">                        with index being the middle point of corresponding interval</span>
<span class="sd">                min_last_block : float, optional</span>
<span class="sd">                    Minimum data availability ratio (0 to 1) in the last block</span>
<span class="sd">                    for it to be used to extract extreme value from.</span>
<span class="sd">                    This is used to discard last block when it is too short.</span>
<span class="sd">                    If None (default), last block is always used.</span>
<span class="sd">            if method is POT:</span>
<span class="sd">                threshold : float, optional</span>
<span class="sd">                    Threshold used to find exceedances.</span>
<span class="sd">                    By default is taken as smallest value.</span>
<span class="sd">                r : pandas.Timedelta or value convertible to timedelta, optional</span>
<span class="sd">                    Duration of window used to decluster the exceedances.</span>
<span class="sd">                    By default r=&#39;24H&#39; (24 hours).</span>
<span class="sd">                    See pandas.to_timedelta for more information.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Validate `extremes`</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extremes</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid type in &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">extremes</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; for the `extremes` &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;argument, must be pandas.Series&quot;</span>
            <span class="p">)</span>
        <span class="n">extremes</span> <span class="o">=</span> <span class="n">extremes</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extremes</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;invalid index type for `extremes`, must be date-time&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">extremes</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`extremes` must have numeric values&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extremes</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">extremes</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">extremes</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`extremes` name doesn&#39;t match that of `data`&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">extremes</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="ow">or</span> <span class="n">extremes</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`extremes` time range must fit within that of data&quot;</span><span class="p">)</span>

        <span class="c1"># Get `method`</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`method` must be either &#39;BM&#39; or &#39;POT&#39;, not &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="c1"># Get `extremes_type`</span>
        <span class="k">if</span> <span class="n">extremes_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;`extremes_type` must be either &#39;BM&#39; or &#39;POT&#39;, not &#39;</span><span class="si">{</span><span class="n">extremes_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Get `extremes_kwargs`</span>
        <span class="n">extremes_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
            <span class="c1"># Get `block_size`</span>
            <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span>
                <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
                    <span class="s2">&quot;block_size&quot;</span><span class="p">,</span>
                    <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">extremes</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">)),</span>
                <span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="s2">&quot;0D&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`block_size` must be a positive timedelta, not </span><span class="si">%s</span><span class="s2">&quot;</span>
                    <span class="o">%</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span>
                <span class="p">)</span>

            <span class="c1"># Get `errors`</span>
            <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;coerce&quot;</span><span class="p">]:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;invalid value in &#39;</span><span class="si">{</span><span class="n">extremes_kwargs</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;for the `errors` argument&quot;</span>
                <span class="p">)</span>

            <span class="c1"># Get `min_last_block`</span>
            <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                        <span class="s2">&quot;`min_last_block` must be a number in the [0, 1] range&quot;</span>
                    <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Get `threshold`</span>
            <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
                <span class="s2">&quot;threshold&quot;</span><span class="p">,</span>
                <span class="p">{</span>
                    <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">extremes</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                    <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="n">extremes</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="p">}[</span><span class="n">extremes_type</span><span class="p">],</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">extremes_type</span> <span class="o">==</span> <span class="s2">&quot;high&quot;</span>
                <span class="ow">and</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="n">extremes_type</span> <span class="o">==</span> <span class="s2">&quot;low&quot;</span>
                <span class="ow">and</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid `threshold` value&quot;</span><span class="p">)</span>

            <span class="c1"># Get `r`</span>
            <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;24h&quot;</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="s2">&quot;0D&quot;</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`r` must be a positive timedelta, not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span>
                <span class="p">)</span>

        <span class="c1"># Check for unrecognized kwargs</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;unrecognized arguments passed in: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Set attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span> <span class="o">=</span> <span class="n">extremes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span> <span class="o">=</span> <span class="n">extremes_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span> <span class="o">=</span> <span class="n">extremes_kwargs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_transformer</span> <span class="o">=</span> <span class="n">ExtremesTransformer</span><span class="p">(</span>
            <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span><span class="p">,</span>
            <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully set extremes&quot;</span><span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_extremes</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">extremes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;BM&quot;</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">block_size</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
        <span class="n">errors</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;coerce&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;raise&quot;</span><span class="p">,</span>
        <span class="n">min_last_block</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_extremes</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">extremes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;POT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;POT&quot;</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">threshold</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">r</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">,</span> <span class="n">typing</span><span class="o">.</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;24h&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_extremes</span><span class="p">(</span>
        <span class="bp">cls</span><span class="p">,</span>
        <span class="n">extremes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
        <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;BM&quot;</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EVA</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an EVA model using pre-defined `extremes`.</span>

<span class="sd">        A typical reason to use this method is when full timeseries is not available</span>
<span class="sd">        and only the extracted extremes (i.e. annual maxima) are known.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        extremes : pd.Series</span>
<span class="sd">            Time series of extreme values.</span>
<span class="sd">        method : str, optional</span>
<span class="sd">            Extreme value extraction method.</span>
<span class="sd">            Supported values:</span>
<span class="sd">                BM (default) - Block Maxima</span>
<span class="sd">                POT - Peaks Over Threshold</span>
<span class="sd">        extremes_type : str, optional</span>
<span class="sd">            high (default) - extreme high values</span>
<span class="sd">            low - extreme low values</span>
<span class="sd">        kwargs:</span>
<span class="sd">            if method is BM:</span>
<span class="sd">                block_size : str or pandas.Timedelta, optional</span>
<span class="sd">                    Block size.</span>
<span class="sd">                    If None (default), then is calculated as median distance</span>
<span class="sd">                    between extreme events.</span>
<span class="sd">                errors : str, optional</span>
<span class="sd">                    raise - raise an exception</span>
<span class="sd">                        when encountering a block with no data</span>
<span class="sd">                    ignore (default) - ignore blocks with no data</span>
<span class="sd">                    coerce - get extreme values for blocks with no data</span>
<span class="sd">                        as mean of all other extreme events in the series</span>
<span class="sd">                        with index being the middle point of corresponding interval</span>
<span class="sd">                min_last_block : float, optional</span>
<span class="sd">                    Minimum data availability ratio (0 to 1) in the last block</span>
<span class="sd">                    for it to be used to extract extreme value from.</span>
<span class="sd">                    This is used to discard last block when it is too short.</span>
<span class="sd">                    If None (default), last block is always used.</span>
<span class="sd">            if method is POT:</span>
<span class="sd">                threshold : float, optional</span>
<span class="sd">                    Threshold used to find exceedances.</span>
<span class="sd">                    By default is taken as smallest value.</span>
<span class="sd">                r : pandas.Timedelta or value convertible to timedelta, optional</span>
<span class="sd">                    Duration of window used to decluster the exceedances.</span>
<span class="sd">                    By default r=&#39;24H&#39; (24 hours).</span>
<span class="sd">                    See pandas.to_timedelta for more information.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        EVA</span>
<span class="sd">            EVA model initialized with `extremes`.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">extremes</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">set_extremes</span><span class="p">(</span>
            <span class="n">extremes</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
            <span class="n">extremes_type</span><span class="o">=</span><span class="n">extremes_type</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span>

    <span class="k">def</span> <span class="nf">plot_extremes</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">show_clusters</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot extreme events.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        figsize : tuple, optional</span>
<span class="sd">            Figure size in inches in format (width, height).</span>
<span class="sd">            By default it is (8, 5).</span>
<span class="sd">        ax : matplotlib.axes._axes.Axes, optional</span>
<span class="sd">            Axes onto which extremes plot is drawn.</span>
<span class="sd">            If None (default), a new figure and axes objects are created.</span>
<span class="sd">        show_clusters : bool, optional</span>
<span class="sd">            If True, show cluster boundaries for POT extremes.</span>
<span class="sd">            Has no effect if extremes were extracted using BM method.</span>
<span class="sd">            May produce wrong cluster boundaries if extremes were set using the</span>
<span class="sd">            `set_extremes` or `from_extremes` methods and threshold and inter-cluster</span>
<span class="sd">            distance (r) arguments were not provided.</span>
<span class="sd">            By default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        figure : matplotlib.figure.Figure</span>
<span class="sd">            Figure object.</span>
<span class="sd">        axes : matplotlib.axes._axes.Axes</span>
<span class="sd">            Axes object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">plot_extremes</span><span class="p">(</span>
            <span class="n">ts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">,</span>
            <span class="n">extremes_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">,</span>
            <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_type</span><span class="p">,</span>
            <span class="n">block_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">show_clusters</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MLE&quot;</span><span class="p">,</span>
        <span class="n">distribution</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">distribution_kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="nd">@typing</span><span class="o">.</span><span class="n">overload</span>
    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;Emcee&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Emcee&quot;</span><span class="p">,</span>
        <span class="n">distribution</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">distribution_kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">n_walkers</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">500</span><span class="p">,</span>
        <span class="n">progress</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="o">...</span>

    <span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="s2">&quot;Emcee&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MLE&quot;</span><span class="p">,</span>
        <span class="n">distribution</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">distribution_kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit a model to the extracted extreme values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        model : str, optional</span>
<span class="sd">            Name of model. By default it is &#39;MLE&#39;.</span>
<span class="sd">            Name of model.</span>
<span class="sd">            Supported models:</span>
<span class="sd">                MLE - Maximum Likelihood Estimate (MLE) model.</span>
<span class="sd">                    Based on &#39;scipy&#39; package (scipy.stats.rv_continuous.fit).</span>
<span class="sd">                Emcee - Markov Chain Monte Carlo (MCMC) model.</span>
<span class="sd">                    Based on &#39;emcee&#39; package by Daniel Foreman-Mackey.</span>
<span class="sd">        distribution : str or scipy.stats.rv_continuous, optional</span>
<span class="sd">            Distribution name compatible with scipy.stats</span>
<span class="sd">            or a subclass of scipy.stats.rv_continuous.</span>
<span class="sd">            See https://docs.scipy.org/doc/scipy/reference/stats.html</span>
<span class="sd">            By default the distribution is selected automatically</span>
<span class="sd">            as best between &#39;genextreme&#39; and &#39;gumbel_r&#39; for &#39;BM&#39; extremes</span>
<span class="sd">            and &#39;genpareto&#39; and &#39;expon&#39; for &#39;POT&#39; extremes.</span>
<span class="sd">            Best distribution is selected using the AIC metric.</span>
<span class="sd">        distribution_kwargs : dict, optional</span>
<span class="sd">            Special keyword arguments, passed to the `.fit` method of the distribution.</span>
<span class="sd">            These keyword arguments represent parameters to be held fixed.</span>
<span class="sd">            Names of parameters to be fixed must have &#39;f&#39; prefixes. Valid parameters:</span>
<span class="sd">                - shape(s): &#39;fc&#39;, e.g. fc=0</span>
<span class="sd">                - location: &#39;floc&#39;, e.g. floc=0</span>
<span class="sd">                - scale: &#39;fscale&#39;, e.g. fscale=1</span>
<span class="sd">            See documentation of a specific scipy.stats distribution</span>
<span class="sd">            for names of available parameters.</span>
<span class="sd">            By default, location parameter for &#39;genpareto&#39; and &#39;expon&#39; distributions</span>
<span class="sd">            is fixed to threshold (POT) or to minimum extremes (BM) value.</span>
<span class="sd">            Set to empty dictionary (distribution_kwargs={}) to avoid this behaviour.</span>
<span class="sd">        kwargs</span>
<span class="sd">            Keyword arguments passed to a model .fit method.</span>
<span class="sd">            MLE model:</span>
<span class="sd">                MLE model takes no additional arguments.</span>
<span class="sd">            Emcee model:</span>
<span class="sd">                n_walkers : int, optional</span>
<span class="sd">                    The number of walkers in the ensemble (default=100).</span>
<span class="sd">                n_samples : int, optional</span>
<span class="sd">                    The number of steps to run (default=500).</span>
<span class="sd">                progress : bool or str, optional</span>
<span class="sd">                    If True, a progress bar will be shown as the sampler progresses.</span>
<span class="sd">                    If a string, will select a specific tqdm progress bar.</span>
<span class="sd">                    Most notable is &#39;notebook&#39;, which shows a progress bar</span>
<span class="sd">                    suitable for Jupyter notebooks.</span>
<span class="sd">                    If False (default), no progress bar will be shown.</span>
<span class="sd">                    This progress bar is a part of the `emcee` package.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Select default distribution</span>
        <span class="k">if</span> <span class="n">distribution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;selecting default distribution for extremes extracted using the &quot;</span>
                <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; method&quot;</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Prepare list of candidate distributions</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
                <span class="n">candidate_distributions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;genextreme&quot;</span><span class="p">,</span> <span class="s2">&quot;gumbel_r&quot;</span><span class="p">]</span>
                <span class="n">_distribution_kwargs</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;POT&quot;</span><span class="p">:</span>
                <span class="n">candidate_distributions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;genpareto&quot;</span><span class="p">,</span> <span class="s2">&quot;expon&quot;</span><span class="p">]</span>
                <span class="n">_distribution_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;floc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                        <span class="s2">&quot;threshold&quot;</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                    <span class="p">)</span>
                <span class="p">}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">AssertionError</span>

            <span class="c1"># Fit MLE model for candidate distributions</span>
            <span class="c1"># and select distribution with smallest AIC</span>
            <span class="n">distribution</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="n">aic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
            <span class="k">for</span> <span class="n">distribution_name</span> <span class="ow">in</span> <span class="n">candidate_distributions</span><span class="p">:</span>
                <span class="n">new_aic</span> <span class="o">=</span> <span class="n">MLE</span><span class="p">(</span>
                    <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="p">,</span>
                    <span class="n">distribution</span><span class="o">=</span><span class="n">distribution_name</span><span class="p">,</span>
                    <span class="n">distribution_kwargs</span><span class="o">=</span><span class="n">_distribution_kwargs</span><span class="p">,</span>
                <span class="p">)</span><span class="o">.</span><span class="n">AIC</span>
                <span class="k">if</span> <span class="n">new_aic</span> <span class="o">&lt;</span> <span class="n">aic</span><span class="p">:</span>
                    <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution_name</span>
                    <span class="n">aic</span> <span class="o">=</span> <span class="n">new_aic</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
                <span class="s2">&quot;selected &#39;</span><span class="si">%s</span><span class="s2">&#39; distribution with AIC score </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
                <span class="n">distribution</span><span class="p">,</span>
                <span class="n">aic</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Get distribution name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">distribution_name</span> <span class="o">=</span> <span class="n">distribution</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">):</span>
            <span class="n">distribution_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid type in </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for the &#39;distribution&#39; argument, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;must be string or scipy.stats.rv_continuous&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Checking if distribution is valid per extreme value theory:</span>
        <span class="c1"># Fisher-Tippet-Gnedenko theorem for &#39;BM&#39;</span>
        <span class="c1"># Pickands–Balkema–de Haan theorem for &#39;POT&#39;</span>
        <span class="k">if</span> <span class="n">distribution_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="p">(</span>
                    <span class="s2">&quot;provided distribution &#39;name&#39; attribute cannot be resolved &quot;</span>
                    <span class="s2">&quot;and distribution validity cannot be verified&quot;</span>
                <span class="p">),</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span> <span class="ow">and</span> <span class="n">distribution_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
                <span class="s2">&quot;gumbel_r&quot;</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="n">message</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">distribution_name</span><span class="si">}</span><span class="s2">&#39; distribution is not &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;recommended to be used with extremes extracted &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;using the &#39;BM&#39; method, &#39;genextreme&#39; or &#39;gumebel_r&#39; &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;should be used per the Fisher-Tippet-Gnedenko theorem&quot;</span>
                    <span class="p">),</span>
                    <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;POT&quot;</span> <span class="ow">and</span> <span class="n">distribution_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;genpareto&quot;</span><span class="p">,</span>
                <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                    <span class="n">message</span><span class="o">=</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">distribution_name</span><span class="si">}</span><span class="s2">&#39; distribution is not &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;recommended to be used with extremes extracted &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;using the &#39;POT&#39; method, &#39;genpareto&#39; or &#39;expon&#39; &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;should be used per the Pickands–Balkema–de Haan theorem&quot;</span>
                    <span class="p">),</span>
                    <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span>
                <span class="p">)</span>

        <span class="c1"># Freeze (fix) location parameter for genpareto/expon distributions</span>
        <span class="k">if</span> <span class="n">distribution_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">distribution_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;genpareto&quot;</span><span class="p">,</span> <span class="s2">&quot;expon&quot;</span><span class="p">]:</span>
            <span class="n">distribution_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;floc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
                <span class="p">)</span>
            <span class="p">}</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
                <span class="s2">&quot;freezing location parameter (floc) at </span><span class="si">%s</span><span class="s2"> for &#39;</span><span class="si">%s</span><span class="s2">&#39; distribution&quot;</span><span class="p">,</span>
                <span class="n">distribution_kwargs</span><span class="p">[</span><span class="s2">&quot;floc&quot;</span><span class="p">],</span>
                <span class="n">distribution_name</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="c1"># Fit model to transformed extremes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span>
            <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
            <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="p">,</span>
            <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
            <span class="n">distribution_kwargs</span><span class="o">=</span><span class="n">distribution_kwargs</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_mcmc_plot_inputs</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">trace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">trace</span>
            <span class="n">trace_map</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit_parameters</span><span class="p">[</span><span class="n">parameter</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">free_parameters</span>
            <span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">_error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;this method is only applicable to MCMC-like models, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;not to &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39; model&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">_error</span>

        <span class="n">parameter_names</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;loc&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Location, $\mu$&quot;</span><span class="p">,</span>
            <span class="s2">&quot;scale&quot;</span><span class="p">:</span> <span class="sa">r</span><span class="s2">&quot;Scale, $\sigma$&quot;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;genextreme&quot;</span><span class="p">,</span> <span class="s2">&quot;genpareto&quot;</span><span class="p">]:</span>
            <span class="n">parameter_names</span><span class="p">[</span><span class="s2">&quot;c&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;Shape, $\xi$&quot;</span>
        <span class="k">if</span> <span class="n">labels</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">parameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">distribution</span><span class="o">.</span><span class="n">free_parameters</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">parameter_names</span><span class="p">[</span><span class="n">parameter</span><span class="p">])</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape parameter &#39;</span><span class="si">{</span><span class="n">parameter</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">trace</span><span class="p">,</span> <span class="n">trace_map</span><span class="p">,</span> <span class="n">labels</span>

    <span class="k">def</span> <span class="nf">plot_trace</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot trace plot for MCMC sampler trace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        burn_in : int, optional</span>
<span class="sd">            Burn-in value (number of first steps to discard for each walker).</span>
<span class="sd">            By default it is 0 (no values are discarded).</span>
<span class="sd">        labels : array-like, optional</span>
<span class="sd">            Sequence of strings with parameter names, used to label axes.</span>
<span class="sd">            If None (default), then axes are labeled sequentially.</span>
<span class="sd">        figsize : tuple, optional</span>
<span class="sd">            Figure size in inches.</span>
<span class="sd">            If None (default), then figure size is calculated automatically</span>
<span class="sd">            as 8 by 2 times number of parameters.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        figure : matplotlib.figure.Figure</span>
<span class="sd">            Figure object.</span>
<span class="sd">        axes : list</span>
<span class="sd">            List with n_parameters Axes objects.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trace</span><span class="p">,</span> <span class="n">trace_map</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mcmc_plot_inputs</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_trace</span><span class="p">(</span>
            <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
            <span class="n">trace_map</span><span class="o">=</span><span class="n">trace_map</span><span class="p">,</span>
            <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_corner</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">labels</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">levels</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot corner plot for MCMC sampler trace.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        burn_in : int, optional</span>
<span class="sd">            Burn-in value (number of first steps to discard for each walker).</span>
<span class="sd">            By default it is 0 (no values are discarded).</span>
<span class="sd">        labels : array-like, optional</span>
<span class="sd">            Sequence of strings with parameter names, used to label axes.</span>
<span class="sd">            If None (default), then axes are labeled sequentially.</span>
<span class="sd">        levels : int, optional</span>
<span class="sd">            Number of Gaussian KDE contours to plot.</span>
<span class="sd">            If None (default), then not shown.</span>
<span class="sd">        figsize : tuple, optional</span>
<span class="sd">            Figure size in inches. By default it is (8, 8).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        figure : matplotlib.figure.Figure</span>
<span class="sd">            Figure object.</span>
<span class="sd">        axes : list</span>
<span class="sd">            2D list with Axes objects of size N by N, where N is `trace.shape[2]`.</span>
<span class="sd">            Empty slots are represented by None. Axes are ordered from left to right</span>
<span class="sd">            top to bottom.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">trace</span><span class="p">,</span> <span class="n">trace_map</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mcmc_plot_inputs</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">plot_corner</span><span class="p">(</span>
            <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
            <span class="n">trace_map</span><span class="o">=</span><span class="n">trace_map</span><span class="p">,</span>
            <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
            <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
            <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_return_value</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">return_period</span><span class="p">,</span>
        <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get return value and confidence interval for given return period(s).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        return_period : array-like</span>
<span class="sd">            Return period or 1D array of return periods.</span>
<span class="sd">            Given as a multiple of `return_period_size`.</span>
<span class="sd">        return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">            Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">            If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">            would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">        alpha : float, optional</span>
<span class="sd">            Width of confidence interval (0, 1).</span>
<span class="sd">            If None (default), return None</span>
<span class="sd">            for upper and lower confidence interval bounds.</span>
<span class="sd">        kwargs</span>
<span class="sd">            Model-specific keyword arguments.</span>
<span class="sd">            If alpha is None, keyword arguments are ignored</span>
<span class="sd">            (error still raised for unrecognized arguments).</span>
<span class="sd">            MLE model:</span>
<span class="sd">                n_samples : int, optional</span>
<span class="sd">                    Number of bootstrap samples used to estimate</span>
<span class="sd">                    confidence interval bounds (default=100).</span>
<span class="sd">            Emcee model:</span>
<span class="sd">                burn_in : int</span>
<span class="sd">                    Burn-in value (number of first steps to discard for each walker).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        return_value : array-like</span>
<span class="sd">            Return values.</span>
<span class="sd">        ci_lower : array-like</span>
<span class="sd">            Lower confidence interval bounds.</span>
<span class="sd">        ci_upper : array-like</span>
<span class="sd">            Upper confidence interval bounds.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Parse the &#39;return_period_size&#39; argument</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_period_size</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_period_size</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">return_period_size</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">return_period_size</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;invalid type in </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">return_period_size</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;for the &#39;return_period_size&#39; argument&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Calculate rate of extreme events</span>
        <span class="c1"># as number of extreme events per `return_period_size`</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
            <span class="n">extremes_rate</span> <span class="o">=</span> <span class="n">return_period_size</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;POT&quot;</span><span class="p">:</span>
            <span class="n">n_periods</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">return_period_size</span>
            <span class="n">extremes_rate</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_periods</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span>

        <span class="c1"># Convert &#39;return_period&#39; to ndarray</span>
        <span class="n">return_period</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">return_period</span> <span class="o">=</span> <span class="n">return_period</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid shape in </span><span class="si">{</span><span class="n">return_period</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for the &#39;return_period&#39; argument, must be 1D array&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Calculate exceedance probability</span>
        <span class="n">exceedance_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">return_period</span> <span class="o">/</span> <span class="n">extremes_rate</span>

        <span class="c1"># Calculate return values</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_return_value</span><span class="p">(</span>
                <span class="n">exceedance_probability</span><span class="o">=</span><span class="n">exceedance_probability</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_summary</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">return_period</span><span class="p">,</span>
        <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a pandas DataFrame with return values and confidence interval bounds.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        return_period : array-like</span>
<span class="sd">            Return period or 1D array of return periods.</span>
<span class="sd">            Given as a multiple of `return_period_size`.</span>
<span class="sd">        return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">            Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">            If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">            would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">        alpha : float, optional</span>
<span class="sd">            Width of confidence interval (0, 1).</span>
<span class="sd">            If None (default), return None</span>
<span class="sd">            for upper and lower confidence interval bounds.</span>
<span class="sd">        kwargs</span>
<span class="sd">            Model-specific keyword arguments.</span>
<span class="sd">            If alpha is None, keyword arguments are ignored</span>
<span class="sd">            (error still raised for unrecognized arguments).</span>
<span class="sd">            MLE model:</span>
<span class="sd">                n_samples : int, optional</span>
<span class="sd">                    Number of bootstrap samples used to estimate</span>
<span class="sd">                    confidence interval bounds (default=100).</span>
<span class="sd">            Emcee model:</span>
<span class="sd">                burn_in : int</span>
<span class="sd">                    Burn-in value (number of first steps to discard for each walker).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        summary : pandas.DataFrame</span>
<span class="sd">            DataFrame with return values and confidence interval bounds.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Convert &#39;return_period&#39; to ndarray</span>
        <span class="n">return_period</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">return_period</span> <span class="o">=</span> <span class="n">return_period</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid shape in </span><span class="si">{</span><span class="n">return_period</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for the &#39;return_period&#39; argument, must be 1D array&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Calculate return values</span>
        <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_return_value</span><span class="p">(</span>
            <span class="n">return_period</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span>
            <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">return_values</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">rv</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
            <span class="n">return_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">return_values</span><span class="p">),</span>
            <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;return period&quot;</span><span class="p">),</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;return value&quot;</span><span class="p">,</span> <span class="s2">&quot;lower ci&quot;</span><span class="p">,</span> <span class="s2">&quot;upper ci&quot;</span><span class="p">],</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_return_values</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">return_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">plotting_position</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;ecdf&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hazen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tukey&quot;</span><span class="p">,</span>
            <span class="s2">&quot;blom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;median&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cunnane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gringorten&quot;</span><span class="p">,</span>
            <span class="s2">&quot;beard&quot;</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot return values and confidence intervals for given return periods.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        return_period : array-like, optional</span>
<span class="sd">            Return period or 1D array of return periods.</span>
<span class="sd">            Given as a multiple of `return_period_size`.</span>
<span class="sd">            If None (default), calculates as 100 values uniformly spaced</span>
<span class="sd">            within the range of return periods of the extracted extreme values.</span>
<span class="sd">        return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">            Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">            If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">            would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">        alpha : float, optional</span>
<span class="sd">            Width of confidence interval (0, 1).</span>
<span class="sd">            If None (default), confidence interval bounds are not plotted.</span>
<span class="sd">        plotting_position : str, optional</span>
<span class="sd">            Plotting position name (default=&#39;weibull&#39;), not case-sensitive.</span>
<span class="sd">            Supported plotting positions:</span>
<span class="sd">                ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</span>
<span class="sd">        ax : matplotlib.axes._axes.Axes, optional</span>
<span class="sd">            Axes onto which the return value plot is drawn.</span>
<span class="sd">            If None (default), a new figure and axes objects are created.</span>
<span class="sd">        figsize : tuple, optional</span>
<span class="sd">            Figure size in inches in format (width, height).</span>
<span class="sd">            By default it is (8, 5).</span>
<span class="sd">        kwargs</span>
<span class="sd">            Model-specific keyword arguments.</span>
<span class="sd">            If alpha is None, keyword arguments are ignored</span>
<span class="sd">            (error still raised for unrecognized arguments).</span>
<span class="sd">            MLE model:</span>
<span class="sd">                n_samples : int, optional</span>
<span class="sd">                    Number of bootstrap samples used to estimate</span>
<span class="sd">                    confidence interval bounds (default=100).</span>
<span class="sd">            Emcee model:</span>
<span class="sd">                burn_in : int</span>
<span class="sd">                    Burn-in value (number of first steps to discard for each walker).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        figure : matplotlib.figure.Figure</span>
<span class="sd">            Figure object.</span>
<span class="sd">        axes : matplotlib.axes._axes.Axes</span>
<span class="sd">            Axes object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get observed return values</span>
        <span class="n">observed_return_values</span> <span class="o">=</span> <span class="n">get_return_periods</span><span class="p">(</span>
            <span class="n">ts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">,</span>
            <span class="n">extremes_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">,</span>
            <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_type</span><span class="p">,</span>
            <span class="n">block_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
            <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Parse the &#39;return_period&#39; argument</span>
        <span class="k">if</span> <span class="n">return_period</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">return_period</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
                <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;return period&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;return period&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
                <span class="mi">100</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Convert &#39;return_period&#39; to ndarray</span>
            <span class="n">return_period</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">return_period</span> <span class="o">=</span> <span class="n">return_period</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;invalid shape in </span><span class="si">{</span><span class="n">return_period</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;for the &#39;return_period&#39; argument, must be 1D array&quot;</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;return_period&#39; must have at least 2 return periods, &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">return_period</span><span class="p">)</span><span class="si">}</span><span class="s2"> was given&quot;</span>
                <span class="p">)</span>

        <span class="c1"># Get modeled return values</span>
        <span class="n">modeled_return_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_summary</span><span class="p">(</span>
            <span class="n">return_period</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span>
            <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Plot return values</span>
        <span class="k">return</span> <span class="n">plot_return_values</span><span class="p">(</span>
            <span class="n">observed_return_values</span><span class="o">=</span><span class="n">observed_return_values</span><span class="p">,</span>
            <span class="n">modeled_return_values</span><span class="o">=</span><span class="n">modeled_return_values</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_probability</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
        <span class="n">plotting_position</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;ecdf&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hazen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tukey&quot;</span><span class="p">,</span>
            <span class="s2">&quot;blom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;median&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cunnane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gringorten&quot;</span><span class="p">,</span>
            <span class="s2">&quot;beard&quot;</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a probability plot (QQ or PP).</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        plot_type : str</span>
<span class="sd">            Probability plot type.</span>
<span class="sd">            Supported values:</span>
<span class="sd">                PP - probability plot</span>
<span class="sd">                QQ - quantile plot</span>
<span class="sd">        return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">            Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">            If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">            would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">        plotting_position : str, optional</span>
<span class="sd">            Plotting position name (default=&#39;weibull&#39;), not case-sensitive.</span>
<span class="sd">            Supported plotting positions:</span>
<span class="sd">                ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</span>
<span class="sd">        ax : matplotlib.axes._axes.Axes, optional</span>
<span class="sd">            Axes onto which the probability plot is drawn.</span>
<span class="sd">            If None (default), a new figure and axes objects are created.</span>
<span class="sd">        figsize : tuple, optional</span>
<span class="sd">            Figure size in inches in format (width, height).</span>
<span class="sd">            By default it is (8, 8).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        figure : matplotlib.figure.Figure</span>
<span class="sd">            Figure object.</span>
<span class="sd">        axes : matplotlib.axes._axes.Axes</span>
<span class="sd">            Axes object.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Get observed return values</span>
        <span class="n">observed_return_values</span> <span class="o">=</span> <span class="n">get_return_periods</span><span class="p">(</span>
            <span class="n">ts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
            <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">,</span>
            <span class="n">extremes_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">,</span>
            <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_type</span><span class="p">,</span>
            <span class="n">block_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
            <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
            <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Get observed and theoretical values</span>
        <span class="c1"># depending on &#39;plot_type&#39;</span>
        <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;PP&quot;</span><span class="p">:</span>
            <span class="n">observed</span> <span class="o">=</span> <span class="p">(</span>
                <span class="mi">1</span> <span class="o">-</span> <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;exceedance probability&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="p">)</span>
            <span class="n">theoretical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
                    <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;QQ&quot;</span><span class="p">:</span>
            <span class="n">observed</span> <span class="o">=</span> <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="n">theoretical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span>
                    <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;exceedance probability&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
                <span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid value in &#39;</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2">&#39; for the &#39;plot_type&#39; argument, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;available values: PP, QQ&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Plot the probability plot</span>
        <span class="k">return</span> <span class="n">plot_probability</span><span class="p">(</span>
            <span class="n">observed</span><span class="o">=</span><span class="n">observed</span><span class="p">,</span>
            <span class="n">theoretical</span><span class="o">=</span><span class="n">theoretical</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
            <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">plot_diagnostic</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">return_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
        <span class="n">alpha</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">plotting_position</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span>
            <span class="s2">&quot;ecdf&quot;</span><span class="p">,</span>
            <span class="s2">&quot;hazen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tukey&quot;</span><span class="p">,</span>
            <span class="s2">&quot;blom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;median&quot;</span><span class="p">,</span>
            <span class="s2">&quot;cunnane&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gringorten&quot;</span><span class="p">,</span>
            <span class="s2">&quot;beard&quot;</span><span class="p">,</span>
        <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
        <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>  <span class="c1"># pragma: no cover</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a diagnostic plot.</span>

<span class="sd">        This plot shows four key plots characterizing the EVA model:</span>
<span class="sd">            - top left : return values plot</span>
<span class="sd">            - top right : probability density (PDF) plot</span>
<span class="sd">            - bottom left : quantile (Q-Q) plot</span>
<span class="sd">            - bottom right : probability (P-P) plot</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        return_period : array-like, optional</span>
<span class="sd">            Return period or 1D array of return periods.</span>
<span class="sd">            Given as a multiple of `return_period_size`.</span>
<span class="sd">            If None (default), calculates as 100 values uniformly spaced</span>
<span class="sd">            within the range of return periods of the extracted extreme values.</span>
<span class="sd">        return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">            Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">            If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">            would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">        alpha : float, optional</span>
<span class="sd">            Width of confidence interval (0, 1).</span>
<span class="sd">            If None (default), confidence interval bounds are not plotted.</span>
<span class="sd">        plotting_position : str, optional</span>
<span class="sd">            Plotting position name (default=&#39;weibull&#39;), not case-sensitive.</span>
<span class="sd">            Supported plotting positions:</span>
<span class="sd">                ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</span>
<span class="sd">        figsize : tuple, optional</span>
<span class="sd">            Figure size in inches in format (width, height).</span>
<span class="sd">            By default it is (8, 8).</span>
<span class="sd">        kwargs</span>
<span class="sd">            Model-specific keyword arguments.</span>
<span class="sd">            If alpha is None, keyword arguments are ignored</span>
<span class="sd">            (error still raised for unrecognized arguments).</span>
<span class="sd">            MLE model:</span>
<span class="sd">                n_samples : int, optional</span>
<span class="sd">                    Number of bootstrap samples used to estimate</span>
<span class="sd">                    confidence interval bounds (default=100).</span>
<span class="sd">            Emcee model:</span>
<span class="sd">                burn_in : int</span>
<span class="sd">                    Burn-in value (number of first steps to discard for each walker).</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        figure : matplotlib.figure.Figure</span>
<span class="sd">            Figure object.</span>
<span class="sd">        axes : tuple</span>
<span class="sd">            Tuple with four Axes objects: return values, pdf, qq, pp</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="n">pyextremes_rc</span><span class="p">):</span>
            <span class="c1"># Create figure</span>
            <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>

            <span class="c1"># Create gridspec</span>
            <span class="n">gs</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span>
                <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
                <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="p">)</span>

            <span class="c1"># Create axes</span>
            <span class="n">ax_rv</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">ax_pdf</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
            <span class="n">ax_qq</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
            <span class="n">ax_pp</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

            <span class="c1"># Plot return values</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_return_values</span><span class="p">(</span>
                <span class="n">return_period</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span>
                <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
                <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax_rv</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax_rv</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Return value plot&quot;</span><span class="p">)</span>
            <span class="n">ax_rv</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>

            <span class="c1"># Plot PDF</span>
            <span class="n">pdf_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
            <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">pdf_support</span><span class="p">))</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Probability density plot&quot;</span><span class="p">)</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability density&quot;</span><span class="p">)</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">histogram_bin_edges</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">),</span>
                <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#5199FF&quot;</span><span class="p">,</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">histogram_bin_edges</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">),</span>
                <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
                <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
                <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;#5199FF&quot;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
                <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdf_support</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F85C50&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
                <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;|&quot;</span><span class="p">,</span>
                <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
                <span class="n">zorder</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax_pdf</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax_pdf</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

            <span class="c1"># Plot Q-Q plot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_probability</span><span class="p">(</span>
                <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;QQ&quot;</span><span class="p">,</span>
                <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
                <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax_qq</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax_qq</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Q-Q plot&quot;</span><span class="p">)</span>

            <span class="c1"># Plot P-P plot</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_probability</span><span class="p">(</span>
                <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;PP&quot;</span><span class="p">,</span>
                <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
                <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
                <span class="n">ax</span><span class="o">=</span><span class="n">ax_pp</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="n">ax_pp</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;P-P plot&quot;</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_rv</span><span class="p">,</span> <span class="n">ax_pdf</span><span class="p">,</span> <span class="n">ax_qq</span><span class="p">,</span> <span class="n">ax_pp</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.__init__" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Initialize EVA model.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series to be analyzed.
Index must be date-time and values must be numeric.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialize EVA model.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data : pandas.Series</span>
<span class="sd">        Time series to be analyzed.</span>
<span class="sd">        Index must be date-time and values must be numeric.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Ensure that `data` is pandas Series</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;invalid type in &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; for the `data` argument, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;must be pandas.Series&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Copy `data` to ensure the original Series object it is not mutated</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Ensure that `data` has correct index and value dtypes</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">message</span> <span class="o">=</span> <span class="s2">&quot;`data` values are not numeric - converting to numeric&quot;</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">_error</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid dtype in </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2"> for the `data` argument, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;must be numeric (subdtype of numpy.number)&quot;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">_error</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;index of `data` must be a sequence of date-time objects, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;not </span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">inferred_type</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Ensure `data` doesn&#39;t have duplicate indices</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n_duplicates</span> <span class="o">:=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">()))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_duplicates</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2"> duplicate indices found in `data` &quot;</span>
            <span class="s2">&quot;- removing duplicate entries&quot;</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">first</span><span class="p">()</span>

    <span class="c1"># Ensure that `data` is sorted</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">is_monotonic_increasing</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;`data` index is not sorted in ascending order - &quot;</span>
            <span class="s2">&quot;sorting `data` by index&quot;</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Ensure that `data` has no invalid entries</span>
    <span class="n">n_nans</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">n_nans</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">message</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">n_nans</span><span class="si">:</span><span class="s2">,d</span><span class="si">}</span><span class="s2"> Null values found in `data` - removing invalid entries&quot;</span>
        <span class="p">)</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">message</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1"># Set the `data` attribute</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__data</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span> <span class="o">=</span> <span class="n">data</span>

    <span class="c1"># Initialize attributes related to extreme value extraction</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_method</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_transformer</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Initialize attributes related to model fitting</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully initialized EVA object&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.fit_model" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">fit_model</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="s1">&#39;MLE&#39;</span><span class="p">,</span> <span class="n">distribution</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">distribution_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.fit_model" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Fit a model to the extracted extreme values.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Name of model. By default it is 'MLE'.
Name of model.
Supported models:
    MLE - Maximum Likelihood Estimate (MLE) model.
        Based on 'scipy' package (scipy.stats.rv_continuous.fit).
    Emcee - Markov Chain Monte Carlo (MCMC) model.
        Based on 'emcee' package by Daniel Foreman-Mackey.</p>
            </div>
          </td>
          <td>
                <code>&#39;MLE&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>distribution</code></td>
          <td>
                <code>str or <span title="scipy.stats.rv_continuous">rv_continuous</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Distribution name compatible with scipy.stats
or a subclass of scipy.stats.rv_continuous.
See https://docs.scipy.org/doc/scipy/reference/stats.html
By default the distribution is selected automatically
as best between 'genextreme' and 'gumbel_r' for 'BM' extremes
and 'genpareto' and 'expon' for 'POT' extremes.
Best distribution is selected using the AIC metric.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>distribution_kwargs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Special keyword arguments, passed to the <code>.fit</code> method of the distribution.
These keyword arguments represent parameters to be held fixed.
Names of parameters to be fixed must have 'f' prefixes. Valid parameters:
    - shape(s): 'fc', e.g. fc=0
    - location: 'floc', e.g. floc=0
    - scale: 'fscale', e.g. fscale=1
See documentation of a specific scipy.stats distribution
for names of available parameters.
By default, location parameter for 'genpareto' and 'expon' distributions
is fixed to threshold (POT) or to minimum extremes (BM) value.
Set to empty dictionary (distribution_kwargs={}) to avoid this behaviour.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Keyword arguments passed to a model .fit method.
MLE model:
    MLE model takes no additional arguments.
Emcee model:
    n_walkers : int, optional
        The number of walkers in the ensemble (default=100).
    n_samples : int, optional
        The number of steps to run (default=500).
    progress : bool or str, optional
        If True, a progress bar will be shown as the sampler progresses.
        If a string, will select a specific tqdm progress bar.
        Most notable is 'notebook', which shows a progress bar
        suitable for Jupyter notebooks.
        If False (default), no progress bar will be shown.
        This progress bar is a part of the <code>emcee</code> package.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">fit_model</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;MLE&quot;</span><span class="p">,</span> <span class="s2">&quot;Emcee&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;MLE&quot;</span><span class="p">,</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">distribution_kwargs</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">dict</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit a model to the extracted extreme values.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    model : str, optional</span>
<span class="sd">        Name of model. By default it is &#39;MLE&#39;.</span>
<span class="sd">        Name of model.</span>
<span class="sd">        Supported models:</span>
<span class="sd">            MLE - Maximum Likelihood Estimate (MLE) model.</span>
<span class="sd">                Based on &#39;scipy&#39; package (scipy.stats.rv_continuous.fit).</span>
<span class="sd">            Emcee - Markov Chain Monte Carlo (MCMC) model.</span>
<span class="sd">                Based on &#39;emcee&#39; package by Daniel Foreman-Mackey.</span>
<span class="sd">    distribution : str or scipy.stats.rv_continuous, optional</span>
<span class="sd">        Distribution name compatible with scipy.stats</span>
<span class="sd">        or a subclass of scipy.stats.rv_continuous.</span>
<span class="sd">        See https://docs.scipy.org/doc/scipy/reference/stats.html</span>
<span class="sd">        By default the distribution is selected automatically</span>
<span class="sd">        as best between &#39;genextreme&#39; and &#39;gumbel_r&#39; for &#39;BM&#39; extremes</span>
<span class="sd">        and &#39;genpareto&#39; and &#39;expon&#39; for &#39;POT&#39; extremes.</span>
<span class="sd">        Best distribution is selected using the AIC metric.</span>
<span class="sd">    distribution_kwargs : dict, optional</span>
<span class="sd">        Special keyword arguments, passed to the `.fit` method of the distribution.</span>
<span class="sd">        These keyword arguments represent parameters to be held fixed.</span>
<span class="sd">        Names of parameters to be fixed must have &#39;f&#39; prefixes. Valid parameters:</span>
<span class="sd">            - shape(s): &#39;fc&#39;, e.g. fc=0</span>
<span class="sd">            - location: &#39;floc&#39;, e.g. floc=0</span>
<span class="sd">            - scale: &#39;fscale&#39;, e.g. fscale=1</span>
<span class="sd">        See documentation of a specific scipy.stats distribution</span>
<span class="sd">        for names of available parameters.</span>
<span class="sd">        By default, location parameter for &#39;genpareto&#39; and &#39;expon&#39; distributions</span>
<span class="sd">        is fixed to threshold (POT) or to minimum extremes (BM) value.</span>
<span class="sd">        Set to empty dictionary (distribution_kwargs={}) to avoid this behaviour.</span>
<span class="sd">    kwargs</span>
<span class="sd">        Keyword arguments passed to a model .fit method.</span>
<span class="sd">        MLE model:</span>
<span class="sd">            MLE model takes no additional arguments.</span>
<span class="sd">        Emcee model:</span>
<span class="sd">            n_walkers : int, optional</span>
<span class="sd">                The number of walkers in the ensemble (default=100).</span>
<span class="sd">            n_samples : int, optional</span>
<span class="sd">                The number of steps to run (default=500).</span>
<span class="sd">            progress : bool or str, optional</span>
<span class="sd">                If True, a progress bar will be shown as the sampler progresses.</span>
<span class="sd">                If a string, will select a specific tqdm progress bar.</span>
<span class="sd">                Most notable is &#39;notebook&#39;, which shows a progress bar</span>
<span class="sd">                suitable for Jupyter notebooks.</span>
<span class="sd">                If False (default), no progress bar will be shown.</span>
<span class="sd">                This progress bar is a part of the `emcee` package.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Select default distribution</span>
    <span class="k">if</span> <span class="n">distribution</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;selecting default distribution for extremes extracted using the &quot;</span>
            <span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; method&quot;</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="c1"># Prepare list of candidate distributions</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
            <span class="n">candidate_distributions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;genextreme&quot;</span><span class="p">,</span> <span class="s2">&quot;gumbel_r&quot;</span><span class="p">]</span>
            <span class="n">_distribution_kwargs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;POT&quot;</span><span class="p">:</span>
            <span class="n">candidate_distributions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;genpareto&quot;</span><span class="p">,</span> <span class="s2">&quot;expon&quot;</span><span class="p">]</span>
            <span class="n">_distribution_kwargs</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;floc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                    <span class="s2">&quot;threshold&quot;</span><span class="p">,</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="p">)</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">AssertionError</span>

        <span class="c1"># Fit MLE model for candidate distributions</span>
        <span class="c1"># and select distribution with smallest AIC</span>
        <span class="n">distribution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">aic</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span>
        <span class="k">for</span> <span class="n">distribution_name</span> <span class="ow">in</span> <span class="n">candidate_distributions</span><span class="p">:</span>
            <span class="n">new_aic</span> <span class="o">=</span> <span class="n">MLE</span><span class="p">(</span>
                <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="p">,</span>
                <span class="n">distribution</span><span class="o">=</span><span class="n">distribution_name</span><span class="p">,</span>
                <span class="n">distribution_kwargs</span><span class="o">=</span><span class="n">_distribution_kwargs</span><span class="p">,</span>
            <span class="p">)</span><span class="o">.</span><span class="n">AIC</span>
            <span class="k">if</span> <span class="n">new_aic</span> <span class="o">&lt;</span> <span class="n">aic</span><span class="p">:</span>
                <span class="n">distribution</span> <span class="o">=</span> <span class="n">distribution_name</span>
                <span class="n">aic</span> <span class="o">=</span> <span class="n">new_aic</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span>
            <span class="s2">&quot;selected &#39;</span><span class="si">%s</span><span class="s2">&#39; distribution with AIC score </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span>
            <span class="n">distribution</span><span class="p">,</span>
            <span class="n">aic</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Get distribution name</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">distribution_name</span> <span class="o">=</span> <span class="n">distribution</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="n">scipy</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">rv_continuous</span><span class="p">):</span>
        <span class="n">distribution_name</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;invalid type in </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">distribution</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;for the &#39;distribution&#39; argument, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;must be string or scipy.stats.rv_continuous&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Checking if distribution is valid per extreme value theory:</span>
    <span class="c1"># Fisher-Tippet-Gnedenko theorem for &#39;BM&#39;</span>
    <span class="c1"># Pickands–Balkema–de Haan theorem for &#39;POT&#39;</span>
    <span class="k">if</span> <span class="n">distribution_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="n">message</span><span class="o">=</span><span class="p">(</span>
                <span class="s2">&quot;provided distribution &#39;name&#39; attribute cannot be resolved &quot;</span>
                <span class="s2">&quot;and distribution validity cannot be verified&quot;</span>
            <span class="p">),</span>
            <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span> <span class="ow">and</span> <span class="n">distribution_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;genextreme&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gumbel_r&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">distribution_name</span><span class="si">}</span><span class="s2">&#39; distribution is not &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;recommended to be used with extremes extracted &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;using the &#39;BM&#39; method, &#39;genextreme&#39; or &#39;gumebel_r&#39; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;should be used per the Fisher-Tippet-Gnedenko theorem&quot;</span>
                <span class="p">),</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;POT&quot;</span> <span class="ow">and</span> <span class="n">distribution_name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
            <span class="s2">&quot;genpareto&quot;</span><span class="p">,</span>
            <span class="s2">&quot;expon&quot;</span><span class="p">,</span>
        <span class="p">]:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="n">message</span><span class="o">=</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">distribution_name</span><span class="si">}</span><span class="s2">&#39; distribution is not &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;recommended to be used with extremes extracted &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;using the &#39;POT&#39; method, &#39;genpareto&#39; or &#39;expon&#39; &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;should be used per the Pickands–Balkema–de Haan theorem&quot;</span>
                <span class="p">),</span>
                <span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="c1"># Freeze (fix) location parameter for genpareto/expon distributions</span>
    <span class="k">if</span> <span class="n">distribution_kwargs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">distribution_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;genpareto&quot;</span><span class="p">,</span> <span class="s2">&quot;expon&quot;</span><span class="p">]:</span>
        <span class="n">distribution_kwargs</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;floc&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
                <span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
            <span class="p">)</span>
        <span class="p">}</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
            <span class="s2">&quot;freezing location parameter (floc) at </span><span class="si">%s</span><span class="s2"> for &#39;</span><span class="si">%s</span><span class="s2">&#39; distribution&quot;</span><span class="p">,</span>
            <span class="n">distribution_kwargs</span><span class="p">[</span><span class="s2">&quot;floc&quot;</span><span class="p">],</span>
            <span class="n">distribution_name</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="c1"># Fit model to transformed extremes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="o">=</span> <span class="n">get_model</span><span class="p">(</span>
        <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
        <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transformed_extremes</span><span class="p">,</span>
        <span class="n">distribution</span><span class="o">=</span><span class="n">distribution</span><span class="p">,</span>
        <span class="n">distribution_kwargs</span><span class="o">=</span><span class="n">distribution_kwargs</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.from_extremes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">from_extremes</span><span class="p">(</span><span class="n">extremes</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BM&#39;</span><span class="p">,</span> <span class="n">extremes_type</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

<a href="#pyextremes.eva.EVA.from_extremes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Create an EVA model using pre-defined <code>extremes</code>.</p>
<p>A typical reason to use this method is when full timeseries is not available
and only the extracted extremes (i.e. annual maxima) are known.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>extremes</code></td>
          <td>
                <code><span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series of extreme values.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Extreme value extraction method.
Supported values:
    BM (default) - Block Maxima
    POT - Peaks Over Threshold</p>
            </div>
          </td>
          <td>
                <code>&#39;BM&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>extremes_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>high (default) - extreme high values
low - extreme low values</p>
            </div>
          </td>
          <td>
                <code>&#39;high&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if method is BM:
    block_size : str or pandas.Timedelta, optional
        Block size.
        If None (default), then is calculated as median distance
        between extreme events.
    errors : str, optional
        raise - raise an exception
            when encountering a block with no data
        ignore (default) - ignore blocks with no data
        coerce - get extreme values for blocks with no data
            as mean of all other extreme events in the series
            with index being the middle point of corresponding interval
    min_last_block : float, optional
        Minimum data availability ratio (0 to 1) in the last block
        for it to be used to extract extreme value from.
        This is used to discard last block when it is too short.
        If None (default), last block is always used.
if method is POT:
    threshold : float, optional
        Threshold used to find exceedances.
        By default is taken as smallest value.
    r : pandas.Timedelta or value convertible to timedelta, optional
        Duration of window used to decluster the exceedances.
        By default r='24H' (24 hours).
        See pandas.to_timedelta for more information.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pyextremes.eva.EVA" href="#pyextremes.eva.EVA">EVA</a></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>EVA model initialized with <code>extremes</code>.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_extremes</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">extremes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;BM&quot;</span><span class="p">,</span>
    <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">EVA</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an EVA model using pre-defined `extremes`.</span>

<span class="sd">    A typical reason to use this method is when full timeseries is not available</span>
<span class="sd">    and only the extracted extremes (i.e. annual maxima) are known.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    extremes : pd.Series</span>
<span class="sd">        Time series of extreme values.</span>
<span class="sd">    method : str, optional</span>
<span class="sd">        Extreme value extraction method.</span>
<span class="sd">        Supported values:</span>
<span class="sd">            BM (default) - Block Maxima</span>
<span class="sd">            POT - Peaks Over Threshold</span>
<span class="sd">    extremes_type : str, optional</span>
<span class="sd">        high (default) - extreme high values</span>
<span class="sd">        low - extreme low values</span>
<span class="sd">    kwargs:</span>
<span class="sd">        if method is BM:</span>
<span class="sd">            block_size : str or pandas.Timedelta, optional</span>
<span class="sd">                Block size.</span>
<span class="sd">                If None (default), then is calculated as median distance</span>
<span class="sd">                between extreme events.</span>
<span class="sd">            errors : str, optional</span>
<span class="sd">                raise - raise an exception</span>
<span class="sd">                    when encountering a block with no data</span>
<span class="sd">                ignore (default) - ignore blocks with no data</span>
<span class="sd">                coerce - get extreme values for blocks with no data</span>
<span class="sd">                    as mean of all other extreme events in the series</span>
<span class="sd">                    with index being the middle point of corresponding interval</span>
<span class="sd">            min_last_block : float, optional</span>
<span class="sd">                Minimum data availability ratio (0 to 1) in the last block</span>
<span class="sd">                for it to be used to extract extreme value from.</span>
<span class="sd">                This is used to discard last block when it is too short.</span>
<span class="sd">                If None (default), last block is always used.</span>
<span class="sd">        if method is POT:</span>
<span class="sd">            threshold : float, optional</span>
<span class="sd">                Threshold used to find exceedances.</span>
<span class="sd">                By default is taken as smallest value.</span>
<span class="sd">            r : pandas.Timedelta or value convertible to timedelta, optional</span>
<span class="sd">                Duration of window used to decluster the exceedances.</span>
<span class="sd">                By default r=&#39;24H&#39; (24 hours).</span>
<span class="sd">                See pandas.to_timedelta for more information.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    EVA</span>
<span class="sd">        EVA model initialized with `extremes`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">extremes</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">set_extremes</span><span class="p">(</span>
        <span class="n">extremes</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="o">=</span><span class="n">extremes_type</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.get_extremes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_extremes</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">extremes_type</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.get_extremes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get extreme events from time series.</p>
<p>Extracts extreme values from the 'self.data' attribute.
Stores extreme values in the 'self.extremes' attribute.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Extreme value extraction method.
Supported values:
    BM - Block Maxima
    POT - Peaks Over Threshold</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>extremes_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>high (default) - get extreme high values
low - get extreme low values</p>
            </div>
          </td>
          <td>
                <code>&#39;high&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if method is BM:
    block_size : str or pandas.Timedelta, optional
        Block size (default='365.2425D').
        See pandas.to_timedelta for more information.
    errors : str, optional
        raise (default) - raise an exception
            when encountering a block with no data
        ignore - ignore blocks with no data
        coerce - get extreme values for blocks with no data
            as mean of all other extreme events in the series
            with index being the middle point of corresponding interval
    min_last_block : float, optional
        Minimum data availability ratio (0 to 1) in the last block
        for it to be used to extract extreme value from.
        This is used to discard last block when it is too short.
        If None (default), last block is always used.
if method is POT:
    threshold : float
        Threshold used to find exceedances.
    r : pandas.Timedelta or value convertible to timedelta, optional
        Duration of window used to decluster the exceedances.
        By default r='24H' (24 hours).
        See pandas.to_timedelta for more information.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_extremes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">],</span>
    <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get extreme events from time series.</span>

<span class="sd">    Extracts extreme values from the &#39;self.data&#39; attribute.</span>
<span class="sd">    Stores extreme values in the &#39;self.extremes&#39; attribute.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    method : str</span>
<span class="sd">        Extreme value extraction method.</span>
<span class="sd">        Supported values:</span>
<span class="sd">            BM - Block Maxima</span>
<span class="sd">            POT - Peaks Over Threshold</span>
<span class="sd">    extremes_type : str, optional</span>
<span class="sd">        high (default) - get extreme high values</span>
<span class="sd">        low - get extreme low values</span>
<span class="sd">    kwargs</span>
<span class="sd">        if method is BM:</span>
<span class="sd">            block_size : str or pandas.Timedelta, optional</span>
<span class="sd">                Block size (default=&#39;365.2425D&#39;).</span>
<span class="sd">                See pandas.to_timedelta for more information.</span>
<span class="sd">            errors : str, optional</span>
<span class="sd">                raise (default) - raise an exception</span>
<span class="sd">                    when encountering a block with no data</span>
<span class="sd">                ignore - ignore blocks with no data</span>
<span class="sd">                coerce - get extreme values for blocks with no data</span>
<span class="sd">                    as mean of all other extreme events in the series</span>
<span class="sd">                    with index being the middle point of corresponding interval</span>
<span class="sd">            min_last_block : float, optional</span>
<span class="sd">                Minimum data availability ratio (0 to 1) in the last block</span>
<span class="sd">                for it to be used to extract extreme value from.</span>
<span class="sd">                This is used to discard last block when it is too short.</span>
<span class="sd">                If None (default), last block is always used.</span>
<span class="sd">        if method is POT:</span>
<span class="sd">            threshold : float</span>
<span class="sd">                Threshold used to find exceedances.</span>
<span class="sd">            r : pandas.Timedelta or value convertible to timedelta, optional</span>
<span class="sd">                Duration of window used to decluster the exceedances.</span>
<span class="sd">                By default r=&#39;24H&#39; (24 hours).</span>
<span class="sd">                See pandas.to_timedelta for more information.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;for method=&#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39; and extremes_type=&#39;</span><span class="si">{</span><span class="n">extremes_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;extracting extreme values </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span> <span class="o">=</span> <span class="n">get_extremes</span><span class="p">(</span>
        <span class="n">method</span><span class="o">=</span><span class="n">method</span><span class="p">,</span>
        <span class="n">ts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="o">=</span><span class="n">extremes_type</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_method</span> <span class="o">=</span> <span class="n">method</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span> <span class="o">=</span> <span class="n">extremes_type</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully extracted extreme values </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;collecting extreme value properties&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_size&quot;</span><span class="p">,</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="s2">&quot;raise&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span>
            <span class="s2">&quot;min_last_block&quot;</span><span class="p">,</span> <span class="kc">None</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;24h&quot;</span><span class="p">))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully collected extreme value properties&quot;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;creating extremes transformer&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_transformer</span> <span class="o">=</span> <span class="n">ExtremesTransformer</span><span class="p">(</span>
        <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully created extremes transformer&quot;</span><span class="p">)</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;removing any previously declared models&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.get_return_value" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_return_value</span><span class="p">(</span><span class="n">return_period</span><span class="p">,</span> <span class="n">return_period_size</span><span class="o">=</span><span class="s1">&#39;365.2425D&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.get_return_value" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Get return value and confidence interval for given return period(s).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>return_period</code></td>
          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return period or 1D array of return periods.
Given as a multiple of <code>return_period_size</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_period_size</code></td>
          <td>
                <code>str or <span title="pandas.Timedelta">Timedelta</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of return periods (default='365.2425D').
If set to '30D', then a return period of 12
would be roughly equivalent to a 1 year return period (360 days).</p>
            </div>
          </td>
          <td>
                <code>&#39;365.2425D&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of confidence interval (0, 1).
If None (default), return None
for upper and lower confidence interval bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model-specific keyword arguments.
If alpha is None, keyword arguments are ignored
(error still raised for unrecognized arguments).
MLE model:
    n_samples : int, optional
        Number of bootstrap samples used to estimate
        confidence interval bounds (default=100).
Emcee model:
    burn_in : int
        Burn-in value (number of first steps to discard for each walker).</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>return_value</code></td>          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return values.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>ci_lower</code></td>          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Lower confidence interval bounds.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>ci_upper</code></td>          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Upper confidence interval bounds.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_return_value</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">return_period</span><span class="p">,</span>
    <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get return value and confidence interval for given return period(s).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    return_period : array-like</span>
<span class="sd">        Return period or 1D array of return periods.</span>
<span class="sd">        Given as a multiple of `return_period_size`.</span>
<span class="sd">    return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">        Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">        If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">        would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        Width of confidence interval (0, 1).</span>
<span class="sd">        If None (default), return None</span>
<span class="sd">        for upper and lower confidence interval bounds.</span>
<span class="sd">    kwargs</span>
<span class="sd">        Model-specific keyword arguments.</span>
<span class="sd">        If alpha is None, keyword arguments are ignored</span>
<span class="sd">        (error still raised for unrecognized arguments).</span>
<span class="sd">        MLE model:</span>
<span class="sd">            n_samples : int, optional</span>
<span class="sd">                Number of bootstrap samples used to estimate</span>
<span class="sd">                confidence interval bounds (default=100).</span>
<span class="sd">        Emcee model:</span>
<span class="sd">            burn_in : int</span>
<span class="sd">                Burn-in value (number of first steps to discard for each walker).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    return_value : array-like</span>
<span class="sd">        Return values.</span>
<span class="sd">    ci_lower : array-like</span>
<span class="sd">        Lower confidence interval bounds.</span>
<span class="sd">    ci_upper : array-like</span>
<span class="sd">        Upper confidence interval bounds.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Parse the &#39;return_period_size&#39; argument</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_period_size</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">return_period_size</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">return_period_size</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">return_period_size</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid type in </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">return_period_size</span><span class="p">)</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for the &#39;return_period_size&#39; argument&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Calculate rate of extreme events</span>
    <span class="c1"># as number of extreme events per `return_period_size`</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
        <span class="n">extremes_rate</span> <span class="o">=</span> <span class="n">return_period_size</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span> <span class="o">==</span> <span class="s2">&quot;POT&quot;</span><span class="p">:</span>
        <span class="n">n_periods</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="n">return_period_size</span>
        <span class="n">extremes_rate</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">)</span> <span class="o">/</span> <span class="n">n_periods</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">AssertionError</span>

    <span class="c1"># Convert &#39;return_period&#39; to ndarray</span>
    <span class="n">return_period</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">return_period</span> <span class="o">=</span> <span class="n">return_period</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;invalid shape in </span><span class="si">{</span><span class="n">return_period</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;for the &#39;return_period&#39; argument, must be 1D array&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Calculate exceedance probability</span>
    <span class="n">exceedance_probability</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">return_period</span> <span class="o">/</span> <span class="n">extremes_rate</span>

    <span class="c1"># Calculate return values</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">get_return_value</span><span class="p">(</span>
            <span class="n">exceedance_probability</span><span class="o">=</span><span class="n">exceedance_probability</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.get_summary" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_summary</span><span class="p">(</span><span class="n">return_period</span><span class="p">,</span> <span class="n">return_period_size</span><span class="o">=</span><span class="s1">&#39;365.2425D&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.get_summary" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Generate a pandas DataFrame with return values and confidence interval bounds.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>return_period</code></td>
          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return period or 1D array of return periods.
Given as a multiple of <code>return_period_size</code>.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_period_size</code></td>
          <td>
                <code>str or <span title="pandas.Timedelta">Timedelta</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of return periods (default='365.2425D').
If set to '30D', then a return period of 12
would be roughly equivalent to a 1 year return period (360 days).</p>
            </div>
          </td>
          <td>
                <code>&#39;365.2425D&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of confidence interval (0, 1).
If None (default), return None
for upper and lower confidence interval bounds.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model-specific keyword arguments.
If alpha is None, keyword arguments are ignored
(error still raised for unrecognized arguments).
MLE model:
    n_samples : int, optional
        Number of bootstrap samples used to estimate
        confidence interval bounds (default=100).
Emcee model:
    burn_in : int
        Burn-in value (number of first steps to discard for each walker).</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>summary</code></td>          <td>
                <code><span title="pandas.DataFrame">DataFrame</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>DataFrame with return values and confidence interval bounds.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_summary</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">return_period</span><span class="p">,</span>
    <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate a pandas DataFrame with return values and confidence interval bounds.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    return_period : array-like</span>
<span class="sd">        Return period or 1D array of return periods.</span>
<span class="sd">        Given as a multiple of `return_period_size`.</span>
<span class="sd">    return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">        Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">        If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">        would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        Width of confidence interval (0, 1).</span>
<span class="sd">        If None (default), return None</span>
<span class="sd">        for upper and lower confidence interval bounds.</span>
<span class="sd">    kwargs</span>
<span class="sd">        Model-specific keyword arguments.</span>
<span class="sd">        If alpha is None, keyword arguments are ignored</span>
<span class="sd">        (error still raised for unrecognized arguments).</span>
<span class="sd">        MLE model:</span>
<span class="sd">            n_samples : int, optional</span>
<span class="sd">                Number of bootstrap samples used to estimate</span>
<span class="sd">                confidence interval bounds (default=100).</span>
<span class="sd">        Emcee model:</span>
<span class="sd">            burn_in : int</span>
<span class="sd">                Burn-in value (number of first steps to discard for each walker).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    summary : pandas.DataFrame</span>
<span class="sd">        DataFrame with return values and confidence interval bounds.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Convert &#39;return_period&#39; to ndarray</span>
    <span class="n">return_period</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">return_period</span> <span class="o">=</span> <span class="n">return_period</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;invalid shape in </span><span class="si">{</span><span class="n">return_period</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;for the &#39;return_period&#39; argument, must be 1D array&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Calculate return values</span>
    <span class="n">rv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_return_value</span><span class="p">(</span>
        <span class="n">return_period</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span>
        <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">return_values</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">rv</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="n">return_values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
        <span class="n">data</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">return_values</span><span class="p">),</span>
        <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">Index</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;return period&quot;</span><span class="p">),</span>
        <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;return value&quot;</span><span class="p">,</span> <span class="s2">&quot;lower ci&quot;</span><span class="p">,</span> <span class="s2">&quot;upper ci&quot;</span><span class="p">],</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.plot_corner" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_corner</span><span class="p">(</span><span class="n">burn_in</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span></code>

<a href="#pyextremes.eva.EVA.plot_corner" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Plot corner plot for MCMC sampler trace.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>burn_in</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Burn-in value (number of first steps to discard for each walker).
By default it is 0 (no values are discarded).</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sequence of strings with parameter names, used to label axes.
If None (default), then axes are labeled sequentially.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>levels</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of Gaussian KDE contours to plot.
If None (default), then not shown.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>figsize</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure size in inches. By default it is (8, 8).</p>
            </div>
          </td>
          <td>
                <code>(8, 8)</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>figure</code></td>          <td>
                <code><span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure object.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>axes</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D list with Axes objects of size N by N, where N is <code>trace.shape[2]</code>.
Empty slots are represented by None. Axes are ordered from left to right
top to bottom.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_corner</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">burn_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">levels</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot corner plot for MCMC sampler trace.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    burn_in : int, optional</span>
<span class="sd">        Burn-in value (number of first steps to discard for each walker).</span>
<span class="sd">        By default it is 0 (no values are discarded).</span>
<span class="sd">    labels : array-like, optional</span>
<span class="sd">        Sequence of strings with parameter names, used to label axes.</span>
<span class="sd">        If None (default), then axes are labeled sequentially.</span>
<span class="sd">    levels : int, optional</span>
<span class="sd">        Number of Gaussian KDE contours to plot.</span>
<span class="sd">        If None (default), then not shown.</span>
<span class="sd">    figsize : tuple, optional</span>
<span class="sd">        Figure size in inches. By default it is (8, 8).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : matplotlib.figure.Figure</span>
<span class="sd">        Figure object.</span>
<span class="sd">    axes : list</span>
<span class="sd">        2D list with Axes objects of size N by N, where N is `trace.shape[2]`.</span>
<span class="sd">        Empty slots are represented by None. Axes are ordered from left to right</span>
<span class="sd">        top to bottom.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">trace</span><span class="p">,</span> <span class="n">trace_map</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mcmc_plot_inputs</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot_corner</span><span class="p">(</span>
        <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
        <span class="n">trace_map</span><span class="o">=</span><span class="n">trace_map</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.plot_diagnostic" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_diagnostic</span><span class="p">(</span><span class="n">return_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_period_size</span><span class="o">=</span><span class="s1">&#39;365.2425D&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plotting_position</span><span class="o">=</span><span class="s1">&#39;weibull&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.plot_diagnostic" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Plot a diagnostic plot.</p>
<p>This plot shows four key plots characterizing the EVA model:
    - top left : return values plot
    - top right : probability density (PDF) plot
    - bottom left : quantile (Q-Q) plot
    - bottom right : probability (P-P) plot</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>return_period</code></td>
          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return period or 1D array of return periods.
Given as a multiple of <code>return_period_size</code>.
If None (default), calculates as 100 values uniformly spaced
within the range of return periods of the extracted extreme values.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>return_period_size</code></td>
          <td>
                <code>str or <span title="pandas.Timedelta">Timedelta</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of return periods (default='365.2425D').
If set to '30D', then a return period of 12
would be roughly equivalent to a 1 year return period (360 days).</p>
            </div>
          </td>
          <td>
                <code>&#39;365.2425D&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of confidence interval (0, 1).
If None (default), confidence interval bounds are not plotted.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>plotting_position</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Plotting position name (default='weibull'), not case-sensitive.
Supported plotting positions:
    ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</p>
            </div>
          </td>
          <td>
                <code>&#39;weibull&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>figsize</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure size in inches in format (width, height).
By default it is (8, 8).</p>
            </div>
          </td>
          <td>
                <code>(8, 8)</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model-specific keyword arguments.
If alpha is None, keyword arguments are ignored
(error still raised for unrecognized arguments).
MLE model:
    n_samples : int, optional
        Number of bootstrap samples used to estimate
        confidence interval bounds (default=100).
Emcee model:
    burn_in : int
        Burn-in value (number of first steps to discard for each walker).</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>figure</code></td>          <td>
                <code><span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure object.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>axes</code></td>          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple with four Axes objects: return values, pdf, qq, pp</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_diagnostic</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">return_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">plotting_position</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span>
        <span class="s2">&quot;ecdf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hazen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tukey&quot;</span><span class="p">,</span>
        <span class="s2">&quot;blom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;median&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cunnane&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gringorten&quot;</span><span class="p">,</span>
        <span class="s2">&quot;beard&quot;</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">):</span>  <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a diagnostic plot.</span>

<span class="sd">    This plot shows four key plots characterizing the EVA model:</span>
<span class="sd">        - top left : return values plot</span>
<span class="sd">        - top right : probability density (PDF) plot</span>
<span class="sd">        - bottom left : quantile (Q-Q) plot</span>
<span class="sd">        - bottom right : probability (P-P) plot</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    return_period : array-like, optional</span>
<span class="sd">        Return period or 1D array of return periods.</span>
<span class="sd">        Given as a multiple of `return_period_size`.</span>
<span class="sd">        If None (default), calculates as 100 values uniformly spaced</span>
<span class="sd">        within the range of return periods of the extracted extreme values.</span>
<span class="sd">    return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">        Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">        If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">        would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        Width of confidence interval (0, 1).</span>
<span class="sd">        If None (default), confidence interval bounds are not plotted.</span>
<span class="sd">    plotting_position : str, optional</span>
<span class="sd">        Plotting position name (default=&#39;weibull&#39;), not case-sensitive.</span>
<span class="sd">        Supported plotting positions:</span>
<span class="sd">            ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</span>
<span class="sd">    figsize : tuple, optional</span>
<span class="sd">        Figure size in inches in format (width, height).</span>
<span class="sd">        By default it is (8, 8).</span>
<span class="sd">    kwargs</span>
<span class="sd">        Model-specific keyword arguments.</span>
<span class="sd">        If alpha is None, keyword arguments are ignored</span>
<span class="sd">        (error still raised for unrecognized arguments).</span>
<span class="sd">        MLE model:</span>
<span class="sd">            n_samples : int, optional</span>
<span class="sd">                Number of bootstrap samples used to estimate</span>
<span class="sd">                confidence interval bounds (default=100).</span>
<span class="sd">        Emcee model:</span>
<span class="sd">            burn_in : int</span>
<span class="sd">                Burn-in value (number of first steps to discard for each walker).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : matplotlib.figure.Figure</span>
<span class="sd">        Figure object.</span>
<span class="sd">    axes : tuple</span>
<span class="sd">        Tuple with four Axes objects: return values, pdf, qq, pp</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">rc_context</span><span class="p">(</span><span class="n">rc</span><span class="o">=</span><span class="n">pyextremes_rc</span><span class="p">):</span>
        <span class="c1"># Create figure</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">96</span><span class="p">)</span>

        <span class="c1"># Create gridspec</span>
        <span class="n">gs</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">gridspec</span><span class="o">.</span><span class="n">GridSpec</span><span class="p">(</span>
            <span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
            <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">hspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span>
            <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
            <span class="n">height_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="p">)</span>

        <span class="c1"># Create axes</span>
        <span class="n">ax_rv</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">ax_pdf</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax_qq</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="n">ax_pp</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">gs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Plot return values</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_return_values</span><span class="p">(</span>
            <span class="n">return_period</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span>
            <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
            <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_rv</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_rv</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Return value plot&quot;</span><span class="p">)</span>
        <span class="n">ax_rv</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>

        <span class="c1"># Plot PDF</span>
        <span class="n">pdf_support</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">pdf_support</span><span class="p">))</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Probability density plot&quot;</span><span class="p">)</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability density&quot;</span><span class="p">)</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">histogram_bin_edges</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">),</span>
            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;#5199FF&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
            <span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">bins</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">histogram_bin_edges</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">),</span>
            <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">rwidth</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span>
            <span class="n">facecolor</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">,</span>
            <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;#5199FF&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pdf_support</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#F85C50&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="p">,</span>
            <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">),</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span>
            <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;|&quot;</span><span class="p">,</span>
            <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
            <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">zorder</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_pdf</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ax_pdf</span><span class="o">.</span><span class="n">get_ylim</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># Plot Q-Q plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_probability</span><span class="p">(</span>
            <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;QQ&quot;</span><span class="p">,</span>
            <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
            <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_qq</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_qq</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Q-Q plot&quot;</span><span class="p">)</span>

        <span class="c1"># Plot P-P plot</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_probability</span><span class="p">(</span>
            <span class="n">plot_type</span><span class="o">=</span><span class="s2">&quot;PP&quot;</span><span class="p">,</span>
            <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
            <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">ax_pp</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="n">ax_pp</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;P-P plot&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax_rv</span><span class="p">,</span> <span class="n">ax_pdf</span><span class="p">,</span> <span class="n">ax_qq</span><span class="p">,</span> <span class="n">ax_pp</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.plot_extremes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_extremes</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">show_clusters</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.plot_extremes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Plot extreme events.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>figsize</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure size in inches in format (width, height).
By default it is (8, 5).</p>
            </div>
          </td>
          <td>
                <code>(8, 5)</code>
          </td>
        </tr>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.axes._axes.Axes">Axes</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axes onto which extremes plot is drawn.
If None (default), a new figure and axes objects are created.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>show_clusters</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If True, show cluster boundaries for POT extremes.
Has no effect if extremes were extracted using BM method.
May produce wrong cluster boundaries if extremes were set using the
<code>set_extremes</code> or <code>from_extremes</code> methods and threshold and inter-cluster
distance (r) arguments were not provided.
By default is False.</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>figure</code></td>          <td>
                <code><span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure object.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>axes</code></td>          <td>
                <code><span title="matplotlib.axes._axes.Axes">Axes</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axes object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_extremes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">show_clusters</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot extreme events.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    figsize : tuple, optional</span>
<span class="sd">        Figure size in inches in format (width, height).</span>
<span class="sd">        By default it is (8, 5).</span>
<span class="sd">    ax : matplotlib.axes._axes.Axes, optional</span>
<span class="sd">        Axes onto which extremes plot is drawn.</span>
<span class="sd">        If None (default), a new figure and axes objects are created.</span>
<span class="sd">    show_clusters : bool, optional</span>
<span class="sd">        If True, show cluster boundaries for POT extremes.</span>
<span class="sd">        Has no effect if extremes were extracted using BM method.</span>
<span class="sd">        May produce wrong cluster boundaries if extremes were set using the</span>
<span class="sd">        `set_extremes` or `from_extremes` methods and threshold and inter-cluster</span>
<span class="sd">        distance (r) arguments were not provided.</span>
<span class="sd">        By default is False.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : matplotlib.figure.Figure</span>
<span class="sd">        Figure object.</span>
<span class="sd">    axes : matplotlib.axes._axes.Axes</span>
<span class="sd">        Axes object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">plot_extremes</span><span class="p">(</span>
        <span class="n">ts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">,</span>
        <span class="n">extremes_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_type</span><span class="p">,</span>
        <span class="n">block_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">threshold</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">r</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">if</span> <span class="n">show_clusters</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.plot_probability" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_probability</span><span class="p">(</span><span class="n">plot_type</span><span class="p">,</span> <span class="n">return_period_size</span><span class="o">=</span><span class="s1">&#39;365.2425D&#39;</span><span class="p">,</span> <span class="n">plotting_position</span><span class="o">=</span><span class="s1">&#39;weibull&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span></code>

<a href="#pyextremes.eva.EVA.plot_probability" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Plot a probability plot (QQ or PP).</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>plot_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Probability plot type.
Supported values:
    PP - probability plot
    QQ - quantile plot</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>return_period_size</code></td>
          <td>
                <code>str or <span title="pandas.Timedelta">Timedelta</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of return periods (default='365.2425D').
If set to '30D', then a return period of 12
would be roughly equivalent to a 1 year return period (360 days).</p>
            </div>
          </td>
          <td>
                <code>&#39;365.2425D&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>plotting_position</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Plotting position name (default='weibull'), not case-sensitive.
Supported plotting positions:
    ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</p>
            </div>
          </td>
          <td>
                <code>&#39;weibull&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.axes._axes.Axes">Axes</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axes onto which the probability plot is drawn.
If None (default), a new figure and axes objects are created.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>figsize</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure size in inches in format (width, height).
By default it is (8, 8).</p>
            </div>
          </td>
          <td>
                <code>(8, 8)</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>figure</code></td>          <td>
                <code><span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure object.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>axes</code></td>          <td>
                <code><span title="matplotlib.axes._axes.Axes">Axes</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axes object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_probability</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">plot_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
    <span class="n">plotting_position</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span>
        <span class="s2">&quot;ecdf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hazen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tukey&quot;</span><span class="p">,</span>
        <span class="s2">&quot;blom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;median&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cunnane&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gringorten&quot;</span><span class="p">,</span>
        <span class="s2">&quot;beard&quot;</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot a probability plot (QQ or PP).</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    plot_type : str</span>
<span class="sd">        Probability plot type.</span>
<span class="sd">        Supported values:</span>
<span class="sd">            PP - probability plot</span>
<span class="sd">            QQ - quantile plot</span>
<span class="sd">    return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">        Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">        If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">        would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">    plotting_position : str, optional</span>
<span class="sd">        Plotting position name (default=&#39;weibull&#39;), not case-sensitive.</span>
<span class="sd">        Supported plotting positions:</span>
<span class="sd">            ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</span>
<span class="sd">    ax : matplotlib.axes._axes.Axes, optional</span>
<span class="sd">        Axes onto which the probability plot is drawn.</span>
<span class="sd">        If None (default), a new figure and axes objects are created.</span>
<span class="sd">    figsize : tuple, optional</span>
<span class="sd">        Figure size in inches in format (width, height).</span>
<span class="sd">        By default it is (8, 8).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : matplotlib.figure.Figure</span>
<span class="sd">        Figure object.</span>
<span class="sd">    axes : matplotlib.axes._axes.Axes</span>
<span class="sd">        Axes object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get observed return values</span>
    <span class="n">observed_return_values</span> <span class="o">=</span> <span class="n">get_return_periods</span><span class="p">(</span>
        <span class="n">ts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">,</span>
        <span class="n">extremes_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_type</span><span class="p">,</span>
        <span class="n">block_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
        <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Get observed and theoretical values</span>
    <span class="c1"># depending on &#39;plot_type&#39;</span>
    <span class="k">if</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;PP&quot;</span><span class="p">:</span>
        <span class="n">observed</span> <span class="o">=</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">-</span> <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;exceedance probability&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="p">)</span>
        <span class="n">theoretical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
                <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">elif</span> <span class="n">plot_type</span> <span class="o">==</span> <span class="s2">&quot;QQ&quot;</span><span class="p">:</span>
        <span class="n">observed</span> <span class="o">=</span> <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="o">.</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">theoretical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extremes_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">isf</span><span class="p">(</span>
                <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;exceedance probability&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
            <span class="p">)</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;invalid value in &#39;</span><span class="si">{</span><span class="n">plot_type</span><span class="si">}</span><span class="s2">&#39; for the &#39;plot_type&#39; argument, &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;available values: PP, QQ&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Plot the probability plot</span>
    <span class="k">return</span> <span class="n">plot_probability</span><span class="p">(</span>
        <span class="n">observed</span><span class="o">=</span><span class="n">observed</span><span class="p">,</span>
        <span class="n">theoretical</span><span class="o">=</span><span class="n">theoretical</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.plot_return_values" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_return_values</span><span class="p">(</span><span class="n">return_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">return_period_size</span><span class="o">=</span><span class="s1">&#39;365.2425D&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plotting_position</span><span class="o">=</span><span class="s1">&#39;weibull&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.plot_return_values" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Plot return values and confidence intervals for given return periods.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>return_period</code></td>
          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Return period or 1D array of return periods.
Given as a multiple of <code>return_period_size</code>.
If None (default), calculates as 100 values uniformly spaced
within the range of return periods of the extracted extreme values.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>return_period_size</code></td>
          <td>
                <code>str or <span title="pandas.Timedelta">Timedelta</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Size of return periods (default='365.2425D').
If set to '30D', then a return period of 12
would be roughly equivalent to a 1 year return period (360 days).</p>
            </div>
          </td>
          <td>
                <code>&#39;365.2425D&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>alpha</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Width of confidence interval (0, 1).
If None (default), confidence interval bounds are not plotted.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>plotting_position</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Plotting position name (default='weibull'), not case-sensitive.
Supported plotting positions:
    ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</p>
            </div>
          </td>
          <td>
                <code>&#39;weibull&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>ax</code></td>
          <td>
                <code><span title="matplotlib.axes._axes.Axes">Axes</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axes onto which the return value plot is drawn.
If None (default), a new figure and axes objects are created.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>figsize</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure size in inches in format (width, height).
By default it is (8, 5).</p>
            </div>
          </td>
          <td>
                <code>(8, 5)</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Model-specific keyword arguments.
If alpha is None, keyword arguments are ignored
(error still raised for unrecognized arguments).
MLE model:
    n_samples : int, optional
        Number of bootstrap samples used to estimate
        confidence interval bounds (default=100).
Emcee model:
    burn_in : int
        Burn-in value (number of first steps to discard for each walker).</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>figure</code></td>          <td>
                <code><span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure object.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>axes</code></td>          <td>
                <code><span title="matplotlib.axes._axes.Axes">Axes</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Axes object.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_return_values</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">return_period</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">return_period_size</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Timedelta</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;365.2425D&quot;</span><span class="p">,</span>
    <span class="n">alpha</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">plotting_position</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span>
        <span class="s2">&quot;ecdf&quot;</span><span class="p">,</span>
        <span class="s2">&quot;hazen&quot;</span><span class="p">,</span>
        <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
        <span class="s2">&quot;tukey&quot;</span><span class="p">,</span>
        <span class="s2">&quot;blom&quot;</span><span class="p">,</span>
        <span class="s2">&quot;median&quot;</span><span class="p">,</span>
        <span class="s2">&quot;cunnane&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gringorten&quot;</span><span class="p">,</span>
        <span class="s2">&quot;beard&quot;</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;weibull&quot;</span><span class="p">,</span>
    <span class="n">ax</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Axes</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot return values and confidence intervals for given return periods.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    return_period : array-like, optional</span>
<span class="sd">        Return period or 1D array of return periods.</span>
<span class="sd">        Given as a multiple of `return_period_size`.</span>
<span class="sd">        If None (default), calculates as 100 values uniformly spaced</span>
<span class="sd">        within the range of return periods of the extracted extreme values.</span>
<span class="sd">    return_period_size : str or pandas.Timedelta, optional</span>
<span class="sd">        Size of return periods (default=&#39;365.2425D&#39;).</span>
<span class="sd">        If set to &#39;30D&#39;, then a return period of 12</span>
<span class="sd">        would be roughly equivalent to a 1 year return period (360 days).</span>
<span class="sd">    alpha : float, optional</span>
<span class="sd">        Width of confidence interval (0, 1).</span>
<span class="sd">        If None (default), confidence interval bounds are not plotted.</span>
<span class="sd">    plotting_position : str, optional</span>
<span class="sd">        Plotting position name (default=&#39;weibull&#39;), not case-sensitive.</span>
<span class="sd">        Supported plotting positions:</span>
<span class="sd">            ecdf, hazen, weibull, tukey, blom, median, cunnane, gringorten, beard</span>
<span class="sd">    ax : matplotlib.axes._axes.Axes, optional</span>
<span class="sd">        Axes onto which the return value plot is drawn.</span>
<span class="sd">        If None (default), a new figure and axes objects are created.</span>
<span class="sd">    figsize : tuple, optional</span>
<span class="sd">        Figure size in inches in format (width, height).</span>
<span class="sd">        By default it is (8, 5).</span>
<span class="sd">    kwargs</span>
<span class="sd">        Model-specific keyword arguments.</span>
<span class="sd">        If alpha is None, keyword arguments are ignored</span>
<span class="sd">        (error still raised for unrecognized arguments).</span>
<span class="sd">        MLE model:</span>
<span class="sd">            n_samples : int, optional</span>
<span class="sd">                Number of bootstrap samples used to estimate</span>
<span class="sd">                confidence interval bounds (default=100).</span>
<span class="sd">        Emcee model:</span>
<span class="sd">            burn_in : int</span>
<span class="sd">                Burn-in value (number of first steps to discard for each walker).</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : matplotlib.figure.Figure</span>
<span class="sd">        Figure object.</span>
<span class="sd">    axes : matplotlib.axes._axes.Axes</span>
<span class="sd">        Axes object.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get observed return values</span>
    <span class="n">observed_return_values</span> <span class="o">=</span> <span class="n">get_return_periods</span><span class="p">(</span>
        <span class="n">ts</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span>
        <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes</span><span class="p">,</span>
        <span class="n">extremes_method</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_method</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_type</span><span class="p">,</span>
        <span class="n">block_size</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">extremes_kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;block_size&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
        <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
        <span class="n">plotting_position</span><span class="o">=</span><span class="n">plotting_position</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Parse the &#39;return_period&#39; argument</span>
    <span class="k">if</span> <span class="n">return_period</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">return_period</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span>
            <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;return period&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
            <span class="n">observed_return_values</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;return period&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="mi">100</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Convert &#39;return_period&#39; to ndarray</span>
        <span class="n">return_period</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">return_period</span> <span class="o">=</span> <span class="n">return_period</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">return_period</span><span class="o">.</span><span class="n">ndim</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid shape in </span><span class="si">{</span><span class="n">return_period</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for the &#39;return_period&#39; argument, must be 1D array&quot;</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">return_period</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;return_period&#39; must have at least 2 return periods, &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">return_period</span><span class="p">)</span><span class="si">}</span><span class="s2"> was given&quot;</span>
            <span class="p">)</span>

    <span class="c1"># Get modeled return values</span>
    <span class="n">modeled_return_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_summary</span><span class="p">(</span>
        <span class="n">return_period</span><span class="o">=</span><span class="n">return_period</span><span class="p">,</span>
        <span class="n">return_period_size</span><span class="o">=</span><span class="n">return_period_size</span><span class="p">,</span>
        <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Plot return values</span>
    <span class="k">return</span> <span class="n">plot_return_values</span><span class="p">(</span>
        <span class="n">observed_return_values</span><span class="o">=</span><span class="n">observed_return_values</span><span class="p">,</span>
        <span class="n">modeled_return_values</span><span class="o">=</span><span class="n">modeled_return_values</span><span class="p">,</span>
        <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.plot_trace" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">plot_trace</span><span class="p">(</span><span class="n">burn_in</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.plot_trace" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Plot trace plot for MCMC sampler trace.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>burn_in</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Burn-in value (number of first steps to discard for each walker).
By default it is 0 (no values are discarded).</p>
            </div>
          </td>
          <td>
                <code>0</code>
          </td>
        </tr>
        <tr>
          <td><code>labels</code></td>
          <td>
                <code>array - like</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Sequence of strings with parameter names, used to label axes.
If None (default), then axes are labeled sequentially.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>figsize</code></td>
          <td>
                <code>tuple</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure size in inches.
If None (default), then figure size is calculated automatically
as 8 by 2 times number of parameters.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>figure</code></td>          <td>
                <code><span title="matplotlib.figure.Figure">Figure</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Figure object.</p>
            </div>
          </td>
        </tr>
        <tr>
<td><code>axes</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List with n_parameters Axes objects.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">plot_trace</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">burn_in</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
    <span class="n">labels</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">figsize</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">typing</span><span class="o">.</span><span class="n">Tuple</span><span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Figure</span><span class="p">,</span> <span class="nb">list</span><span class="p">]:</span>  <span class="c1"># pragma: no cover</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot trace plot for MCMC sampler trace.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    burn_in : int, optional</span>
<span class="sd">        Burn-in value (number of first steps to discard for each walker).</span>
<span class="sd">        By default it is 0 (no values are discarded).</span>
<span class="sd">    labels : array-like, optional</span>
<span class="sd">        Sequence of strings with parameter names, used to label axes.</span>
<span class="sd">        If None (default), then axes are labeled sequentially.</span>
<span class="sd">    figsize : tuple, optional</span>
<span class="sd">        Figure size in inches.</span>
<span class="sd">        If None (default), then figure size is calculated automatically</span>
<span class="sd">        as 8 by 2 times number of parameters.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    figure : matplotlib.figure.Figure</span>
<span class="sd">        Figure object.</span>
<span class="sd">    axes : list</span>
<span class="sd">        List with n_parameters Axes objects.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">trace</span><span class="p">,</span> <span class="n">trace_map</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_mcmc_plot_inputs</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">plot_trace</span><span class="p">(</span>
        <span class="n">trace</span><span class="o">=</span><span class="n">trace</span><span class="p">,</span>
        <span class="n">trace_map</span><span class="o">=</span><span class="n">trace_map</span><span class="p">,</span>
        <span class="n">burn_in</span><span class="o">=</span><span class="n">burn_in</span><span class="p">,</span>
        <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">,</span>
        <span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pyextremes.eva.EVA.set_extremes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">set_extremes</span><span class="p">(</span><span class="n">extremes</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;BM&#39;</span><span class="p">,</span> <span class="n">extremes_type</span><span class="o">=</span><span class="s1">&#39;high&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#pyextremes.eva.EVA.set_extremes" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">
  
      <p>Set extreme values.</p>
<p>This method is used to set extreme values onto the model instead
of deriving them from data directly using the 'get_extremes' method.
This way user can set extremes calculated using a custom methodology.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>extremes</code></td>
          <td>
                <code><span title="pandas.Series">Series</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Time series of extreme values to be set onto the model.
Must be numeric, have date-time index, and have the same name
as self.data.</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>method</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Extreme value extraction method.
Supported values:
    BM (default) - Block Maxima
    POT - Peaks Over Threshold</p>
            </div>
          </td>
          <td>
                <code>&#39;BM&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>extremes_type</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>high (default) - extreme high values
low - extreme low values</p>
            </div>
          </td>
          <td>
                <code>&#39;high&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if method is BM:
    block_size : str or pandas.Timedelta, optional
        Block size.
        If None (default), then is calculated as median distance
        between extreme events.
    errors : str, optional
        raise - raise an exception
            when encountering a block with no data
        ignore (default) - ignore blocks with no data
        coerce - get extreme values for blocks with no data
            as mean of all other extreme events in the series
            with index being the middle point of corresponding interval
    min_last_block : float, optional
        Minimum data availability ratio (0 to 1) in the last block
        for it to be used to extract extreme value from.
        This is used to discard last block when it is too short.
        If None (default), last block is always used.
if method is POT:
    threshold : float, optional
        Threshold used to find exceedances.
        By default is taken as smallest value.
    r : pandas.Timedelta or value convertible to timedelta, optional
        Duration of window used to decluster the exceedances.
        By default r='24H' (24 hours).
        See pandas.to_timedelta for more information.</p>
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>src/pyextremes/eva.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_extremes</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">extremes</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">,</span>
    <span class="n">method</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;BM&quot;</span><span class="p">,</span>
    <span class="n">extremes_type</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;high&quot;</span><span class="p">,</span>
    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Set extreme values.</span>

<span class="sd">    This method is used to set extreme values onto the model instead</span>
<span class="sd">    of deriving them from data directly using the &#39;get_extremes&#39; method.</span>
<span class="sd">    This way user can set extremes calculated using a custom methodology.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    extremes : pd.Series</span>
<span class="sd">        Time series of extreme values to be set onto the model.</span>
<span class="sd">        Must be numeric, have date-time index, and have the same name</span>
<span class="sd">        as self.data.</span>
<span class="sd">    method : str, optional</span>
<span class="sd">        Extreme value extraction method.</span>
<span class="sd">        Supported values:</span>
<span class="sd">            BM (default) - Block Maxima</span>
<span class="sd">            POT - Peaks Over Threshold</span>
<span class="sd">    extremes_type : str, optional</span>
<span class="sd">        high (default) - extreme high values</span>
<span class="sd">        low - extreme low values</span>
<span class="sd">    kwargs:</span>
<span class="sd">        if method is BM:</span>
<span class="sd">            block_size : str or pandas.Timedelta, optional</span>
<span class="sd">                Block size.</span>
<span class="sd">                If None (default), then is calculated as median distance</span>
<span class="sd">                between extreme events.</span>
<span class="sd">            errors : str, optional</span>
<span class="sd">                raise - raise an exception</span>
<span class="sd">                    when encountering a block with no data</span>
<span class="sd">                ignore (default) - ignore blocks with no data</span>
<span class="sd">                coerce - get extreme values for blocks with no data</span>
<span class="sd">                    as mean of all other extreme events in the series</span>
<span class="sd">                    with index being the middle point of corresponding interval</span>
<span class="sd">            min_last_block : float, optional</span>
<span class="sd">                Minimum data availability ratio (0 to 1) in the last block</span>
<span class="sd">                for it to be used to extract extreme value from.</span>
<span class="sd">                This is used to discard last block when it is too short.</span>
<span class="sd">                If None (default), last block is always used.</span>
<span class="sd">        if method is POT:</span>
<span class="sd">            threshold : float, optional</span>
<span class="sd">                Threshold used to find exceedances.</span>
<span class="sd">                By default is taken as smallest value.</span>
<span class="sd">            r : pandas.Timedelta or value convertible to timedelta, optional</span>
<span class="sd">                Duration of window used to decluster the exceedances.</span>
<span class="sd">                By default r=&#39;24H&#39; (24 hours).</span>
<span class="sd">                See pandas.to_timedelta for more information.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Validate `extremes`</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extremes</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;invalid type in &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">extremes</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; for the `extremes` &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;argument, must be pandas.Series&quot;</span>
        <span class="p">)</span>
    <span class="n">extremes</span> <span class="o">=</span> <span class="n">extremes</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">deep</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">extremes</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DatetimeIndex</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;invalid index type for `extremes`, must be date-time&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">extremes</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;`extremes` must have numeric values&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">extremes</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">extremes</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">extremes</span><span class="o">.</span><span class="n">name</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`extremes` name doesn&#39;t match that of `data`&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="p">(</span>
        <span class="n">extremes</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="ow">or</span> <span class="n">extremes</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
    <span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;`extremes` time range must fit within that of data&quot;</span><span class="p">)</span>

    <span class="c1"># Get `method`</span>
    <span class="k">if</span> <span class="n">method</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;BM&quot;</span><span class="p">,</span> <span class="s2">&quot;POT&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;`method` must be either &#39;BM&#39; or &#39;POT&#39;, not &#39;</span><span class="si">{</span><span class="n">method</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># Get `extremes_type`</span>
    <span class="k">if</span> <span class="n">extremes_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;high&quot;</span><span class="p">,</span> <span class="s2">&quot;low&quot;</span><span class="p">]:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;`extremes_type` must be either &#39;BM&#39; or &#39;POT&#39;, not &#39;</span><span class="si">{</span><span class="n">extremes_type</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Get `extremes_kwargs`</span>
    <span class="n">extremes_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;BM&quot;</span><span class="p">:</span>
        <span class="c1"># Get `block_size`</span>
        <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
                <span class="s2">&quot;block_size&quot;</span><span class="p">,</span>
                <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">extremes</span><span class="o">.</span><span class="n">index</span><span class="p">),</span> <span class="mf">0.5</span><span class="p">)),</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="s2">&quot;0D&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`block_size` must be a positive timedelta, not </span><span class="si">%s</span><span class="s2">&quot;</span>
                <span class="o">%</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;block_size&quot;</span><span class="p">]</span>
            <span class="p">)</span>

        <span class="c1"># Get `errors`</span>
        <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;errors&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;errors&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="s2">&quot;coerce&quot;</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;invalid value in &#39;</span><span class="si">{</span><span class="n">extremes_kwargs</span><span class="p">[</span><span class="s1">&#39;errors&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;for the `errors` argument&quot;</span>
            <span class="p">)</span>

        <span class="c1"># Get `min_last_block`</span>
        <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;min_last_block&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;`min_last_block` must be a number in the [0, 1] range&quot;</span>
                <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Get `threshold`</span>
        <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span>
            <span class="s2">&quot;threshold&quot;</span><span class="p">,</span>
            <span class="p">{</span>
                <span class="s2">&quot;high&quot;</span><span class="p">:</span> <span class="n">extremes</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                <span class="s2">&quot;low&quot;</span><span class="p">:</span> <span class="n">extremes</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span>
            <span class="p">}[</span><span class="n">extremes_type</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span>
            <span class="n">extremes_type</span> <span class="o">==</span> <span class="s2">&quot;high&quot;</span>
            <span class="ow">and</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">min</span><span class="p">()</span>
        <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
            <span class="n">extremes_type</span> <span class="o">==</span> <span class="s2">&quot;low&quot;</span>
            <span class="ow">and</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;threshold&quot;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">extremes</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;invalid `threshold` value&quot;</span><span class="p">)</span>

        <span class="c1"># Get `r`</span>
        <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="s2">&quot;24h&quot;</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">(</span><span class="s2">&quot;0D&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;`r` must be a positive timedelta, not </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">extremes_kwargs</span><span class="p">[</span><span class="s2">&quot;r&quot;</span><span class="p">]</span>
            <span class="p">)</span>

    <span class="c1"># Check for unrecognized kwargs</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;unrecognized arguments passed in: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>

    <span class="c1"># Set attributes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span> <span class="o">=</span> <span class="n">extremes</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_method</span> <span class="o">=</span> <span class="n">method</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span> <span class="o">=</span> <span class="n">extremes_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_kwargs</span> <span class="o">=</span> <span class="n">extremes_kwargs</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__extremes_transformer</span> <span class="o">=</span> <span class="n">ExtremesTransformer</span><span class="p">(</span>
        <span class="n">extremes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__extremes</span><span class="p">,</span>
        <span class="n">extremes_type</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__extremes_type</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">__model</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;successfully set extremes&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 George Bocharov
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/georgebv/pyextremes" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/gbocharov/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.instant", "navigation.top"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.fe8b6f2b.min.js"></script>
      
        <script src="../../js/config.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>